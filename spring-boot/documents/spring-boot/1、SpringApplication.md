<div class="article-entry" itemprop="articleBody">

<h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span> <span class="comment">// &lt;1&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MVCApplication</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        SpringApplication.run(MVCApplication.class, args); <span class="comment">// &lt;2&gt;</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œä½¿ç”¨ <code>@SpringBootApplication</code> æ³¨è§£ï¼Œæ ‡æ˜æ˜¯ Spring Boot åº”ç”¨ã€‚é€šè¿‡å®ƒï¼Œå¯ä»¥å¼€å¯è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ã€‚</li>
<li><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringApplication#run(Class&lt;?&gt;... primarySources)</code> æ–¹æ³•ï¼Œå¯åŠ¨ Spring Boot åº”ç”¨ã€‚</li>
</ul>
<p>ä¸Šè¿°çš„ä»£ç ï¼Œæ˜¯æˆ‘ä»¬ä½¿ç”¨ Spring Boot æ—¶ï¼Œæœ€æœ€æœ€å¸¸ç”¨çš„ä»£ç ã€‚è€Œæœ¬æ–‡ï¼Œæˆ‘ä»¬å…ˆæ¥åˆ†æ Spring Boot åº”ç”¨çš„<strong>å¯åŠ¨è¿‡ç¨‹</strong>ã€‚</p>
<blockquote>
<p>å…³äº <code>@SpringApplication</code> æ³¨è§£ï¼Œæˆ‘ä»¬ä¼šåé¢å•ç‹¬å¼€æ–‡ç« ï¼Œè¯¦ç»†è§£æã€‚</p>
</blockquote>
<h1 id="2-SpringApplication"><a href="#2-SpringApplication" class="headerlink" title="2. SpringApplication"></a>2. SpringApplication</h1><p><code>org.springframework.boot.SpringApplication</code> ï¼ŒSpring åº”ç”¨å¯åŠ¨å™¨ã€‚æ­£å¦‚å…¶ä»£ç ä¸Šæ‰€æ·»åŠ çš„æ³¨é‡Šï¼Œå®ƒæ¥æä¾›å¯åŠ¨ Spring åº”ç”¨çš„åŠŸèƒ½ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">Class that can be used to bootstrap and launch a Spring application from a Java main method.</span><br></pre></td></tr></tbody></table></figure>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨å®ƒæä¾›çš„<strong>é™æ€</strong>æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">	SpringApplication.run(<span class="keyword">new</span> Class&lt;?&gt;[<span class="number">0</span>], args);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(Class&lt;?&gt; primarySource, String... args)</span> </span>{</span><br><span class="line">	<span class="keyword">return</span> run(<span class="keyword">new</span> Class&lt;?&gt;[] { primarySource }, args);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(Class&lt;?&gt;[] primarySources, String[] args)</span> </span>{</span><br><span class="line">	<span class="comment">// åˆ›å»º SpringApplication å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œè¿è¡Œã€‚</span></span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> SpringApplication(primarySources).run(args);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å‰ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼Œæœ€ç»ˆè°ƒç”¨çš„æ˜¯ç¬¬ 3 ä¸ªé™æ€æ–¹æ³•ã€‚è€Œç¬¬ 3 ä¸ªé™æ€æ–¹æ³•ï¼Œå®ç°çš„é€»è¾‘å°±æ˜¯ï¼š<ul>
<li>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª SpringApplication å¯¹è±¡ã€‚è¯¦ç»†çš„è§£æï¼Œè§ <a href="#">ã€Œ2.1 æ„é€ æ–¹æ³•ã€</a> ã€‚</li>
<li>ç„¶åï¼Œè°ƒç”¨ <code>SpringApplication#run(Class&lt;?&gt; primarySource, String... args)</code> æ–¹æ³•ï¼Œè¿è¡Œ Spring åº”ç”¨ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.2 runã€</a> ã€‚</li>
</ul>
</li>
</ul>
<h2 id="2-1-æ„é€ æ–¹æ³•"><a href="#2-1-æ„é€ æ–¹æ³•" class="headerlink" title="2.1 æ„é€ æ–¹æ³•"></a>2.1 æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * èµ„æºåŠ è½½å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> ResourceLoader resourceLoader;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸»è¦çš„ Java Config ç±»çš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Set&lt;Class&lt;?&gt;&gt; primarySources;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Web åº”ç”¨ç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> WebApplicationType webApplicationType;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ApplicationContextInitializer æ•°ç»„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> List&lt;ApplicationContextInitializer&lt;?&gt;&gt; initializers;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ApplicationListener æ•°ç»„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> List&lt;ApplicationListener&lt;?&gt;&gt; listeners;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringApplication</span><span class="params">(Class&lt;?&gt;... primarySources)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>(<span class="keyword">null</span>, primarySources);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">SpringApplication</span><span class="params">(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.resourceLoader = resourceLoader;</span><br><span class="line">    Assert.notNull(primarySources, <span class="string">"PrimarySources must not be null"</span>);</span><br><span class="line">    <span class="keyword">this</span>.primarySources = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(Arrays.asList(primarySources));</span><br><span class="line">    <span class="keyword">this</span>.webApplicationType = WebApplicationType.deduceFromClasspath();</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– initializers å±æ€§</span></span><br><span class="line">    setInitializers((Collection) getSpringFactoriesInstances(ApplicationContextInitializer.class));</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– listeners å±æ€§</span></span><br><span class="line">    setListeners((Collection) getSpringFactoriesInstances(ApplicationListener.class));</span><br><span class="line">    <span class="keyword">this</span>.mainApplicationClass = deduceMainApplicationClass();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>SpringApplication çš„å˜é‡æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å…ˆåªçœ‹æ„é€ æ–¹æ³•æåˆ°çš„å‡ ä¸ªã€‚</li>
<li><code>resourceLoader</code> å±æ€§ï¼Œèµ„æºåŠ è½½å™¨ã€‚å¯ä»¥æš‚æ—¶ä¸ç†è§£ï¼Œæ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ <a href="http://svip.iocoder.cn/Spring/IoC-load-Resource/?vip">ã€Šã€æ­»ç£• Springã€‘â€”â€” IoC ä¹‹ Spring ç»Ÿä¸€èµ„æºåŠ è½½ç­–ç•¥ã€‹</a> æ–‡ç« ã€‚</li>
<li><code>primarySources</code> å±æ€§ï¼Œä¸»è¦çš„ Java Config ç±»çš„æ•°ç»„ã€‚åœ¨æ–‡åˆæä¾›çš„ç¤ºä¾‹ï¼Œå°±æ˜¯ MVCApplication ç±»ã€‚</li>
<li><code>webApplicationType</code> å±æ€§ï¼Œè°ƒç”¨ <code>WebApplicationType#deduceFromClasspath()</code> æ–¹æ³•ï¼Œé€šè¿‡ classpath ï¼Œåˆ¤æ–­ Web åº”ç”¨ç±»å‹ã€‚<ul>
<li>å…·ä½“çš„åŸç†æ˜¯ï¼Œæ˜¯å¦å­˜åœ¨æŒ‡å®šçš„ç±»ï¼Œè‰¿è‰¿å·²ç»åœ¨ <a href="https://github.com/YunaiV/spring-boot/blob/master/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/WebApplicationType.java" rel="external nofollow noopener noreferrer" target="_blank">WebApplicationType</a> ä¸Šçš„æ–¹æ³•æ·»åŠ äº†æ³¨é‡Šï¼Œç›´æ¥ç…ä¸€çœ¼å°±æ˜ç™½äº†ã€‚</li>
<li>è¿™ä¸ªå±æ€§ï¼Œåœ¨ä¸‹é¢çš„ <code>#createApplicationContext()</code> æ–¹æ³•ï¼Œå°†æ ¹æ®å®ƒçš„å€¼ï¼ˆç±»å‹ï¼‰ï¼Œåˆ›å»ºä¸åŒç±»å‹çš„ ApplicationContext å¯¹è±¡ï¼Œå³ Spring å®¹å™¨çš„ç±»å‹ä¸åŒã€‚</li>
</ul>
</li>
<li><code>initializers</code> å±æ€§ï¼ŒApplicationContextInitializer æ•°ç»„ã€‚<ul>
<li>é€šè¿‡ <code>#getSpringFactoriesInstances(Class&lt;T&gt; type)</code> æ–¹æ³•ï¼Œè¿›è¡Œè·å¾— ApplicationContextInitializer ç±»å‹çš„å¯¹è±¡æ•°ç»„ï¼Œè¯¦ç»†çš„è§£æï¼Œè§ <a href="#">ã€Œ2.1.1 getSpringFactoriesInstancesã€</a> æ–¹æ³•ã€‚</li>
<li>å‡è®¾åªåœ¨ Spring MVC çš„ç¯å¢ƒä¸‹ï¼Œ<code>initializers</code> å±æ€§çš„ç»“æœå¦‚ä¸‹å›¾ï¼š<img src="http://static2.iocoder.cn/images/Spring-Boot/2021-01-07/01.jpg" alt="`initializers` å±æ€§"></li>
</ul>
</li>
<li><code>listeners</code> å±æ€§ï¼ŒApplicationListener æ•°ç»„ã€‚<ul>
<li>ä¹Ÿæ˜¯é€šè¿‡ <code>#getSpringFactoriesInstances(Class&lt;T&gt; type)</code> æ–¹æ³•ï¼Œè¿›è¡Œè·å¾— ApplicationListener ç±»å‹çš„å¯¹è±¡æ•°ç»„ã€‚</li>
<li>å‡è®¾åªåœ¨ Spring MVC çš„ç¯å¢ƒä¸‹ï¼Œ<code>listeners</code> å±æ€§çš„ç»“æœå¦‚ä¸‹å›¾ï¼š<img src="http://static2.iocoder.cn/images/Spring-Boot/2021-01-07/02.jpg" alt="`listeners` å±æ€§"></li>
</ul>
</li>
<li><p><code>mainApplicationClass</code> å±æ€§ï¼Œè°ƒç”¨ <code>#deduceMainApplicationClass()</code> æ–¹æ³•ï¼Œè·å¾—æ˜¯è°ƒç”¨äº†å“ªä¸ª <code>#main(String[] args)</code> æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Class&lt;?&gt; deduceMainApplicationClass() {</span><br><span class="line">	<span class="keyword">try</span> {</span><br><span class="line">		<span class="comment">// è·å¾—å½“å‰ StackTraceElement æ•°ç»„</span></span><br><span class="line">		StackTraceElement[] stackTrace = <span class="keyword">new</span> RuntimeException().getStackTrace();</span><br><span class="line">		<span class="comment">// åˆ¤æ–­å“ªä¸ªæ‰§è¡Œäº† main æ–¹æ³•</span></span><br><span class="line">		<span class="keyword">for</span> (StackTraceElement stackTraceElement : stackTrace) {</span><br><span class="line">			<span class="keyword">if</span> (<span class="string">"main"</span>.equals(stackTraceElement.getMethodName())) {</span><br><span class="line">				<span class="keyword">return</span> Class.forName(stackTraceElement.getClassName());</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	} <span class="keyword">catch</span> (ClassNotFoundException ex) {</span><br><span class="line">		<span class="comment">// Swallow and continue</span></span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åœ¨æ–‡åˆçš„ä¾‹å­ä¸­ï¼Œå°±æ˜¯ MVCApplication ç±»ã€‚</li>
<li>è¿™ä¸ª <code>mainApplicationClass</code> å±æ€§ï¼Œæ²¡æœ‰ä»€ä¹ˆé€»è¾‘ä¸Šçš„ç”¨é€”ï¼Œä¸»è¦å°±æ˜¯ç”¨æ¥æ‰“å°ä¸‹æ—¥å¿—ï¼Œè¯´æ˜æ˜¯é€šè¿‡è¿™ä¸ªç±»å¯åŠ¨ Spring åº”ç”¨çš„ã€‚</li>
</ul>
</li>
</ul>
<h3 id="2-1-1-getSpringFactoriesInstances"><a href="#2-1-1-getSpringFactoriesInstances" class="headerlink" title="2.1.1 getSpringFactoriesInstances"></a>2.1.1 getSpringFactoriesInstances</h3><p><code>#getSpringFactoriesInstances(Class&lt;T&gt; type)</code> æ–¹æ³•ï¼Œè·å¾—æŒ‡å®šç±»ç±»å¯¹åº”çš„å¯¹è±¡ä»¬ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">Collection&lt;T&gt; <span class="title">getSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> getSpringFactoriesInstances(type, <span class="keyword">new</span> Class&lt;?&gt;[] {});</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">Collection&lt;T&gt; <span class="title">getSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type,</span></span></span><br><span class="line"><span class="function"><span class="params">        Class&lt;?&gt;[] parameterTypes, Object... args)</span> </span>{</span><br><span class="line">    ClassLoader classLoader = getClassLoader();</span><br><span class="line">    <span class="comment">// Use names and ensure unique to protect against duplicates</span></span><br><span class="line">    <span class="comment">// &lt;1&gt; åŠ è½½æŒ‡å®šç±»å‹å¯¹åº”çš„ï¼Œåœ¨ `META-INF/spring.factories` é‡Œçš„ç±»åçš„æ•°ç»„</span></span><br><span class="line">    Set&lt;String&gt; names = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(</span><br><span class="line">            SpringFactoriesLoader.loadFactoryNames(type, classLoader));</span><br><span class="line">    <span class="comment">// &lt;2&gt; åˆ›å»ºå¯¹è±¡ä»¬</span></span><br><span class="line">    List&lt;T&gt; instances = createSpringFactoriesInstances(type, parameterTypes,</span><br><span class="line">            classLoader, args, names);</span><br><span class="line">    <span class="comment">// &lt;3&gt; æ’åºå¯¹è±¡ä»¬</span></span><br><span class="line">    AnnotationAwareOrderComparator.sort(instances);</span><br><span class="line">    <span class="keyword">return</span> instances;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringFactoriesLoader#loadFactoryNames(Class&lt;?&gt; factoryClass, ClassLoader classLoader)</code> æ–¹æ³•ï¼ŒåŠ è½½æŒ‡å®šç±»å‹å¯¹åº”çš„ï¼Œåœ¨ <code>META-INF/spring.factories</code> é‡Œçš„ç±»åçš„æ•°ç»„ã€‚<ul>
<li>åœ¨ <a href="https://github.com/YunaiV/spring-boot/blob/master/spring-boot-project/spring-boot-autoconfigure/src/main/resources/META-INF/spring.factories" rel="external nofollow noopener noreferrer" target="_blank"><code>META-INF/spring.factories</code></a> æ–‡ä»¶ä¸­ï¼Œä¼šä»¥ KEY-VALUE çš„æ ¼å¼ï¼Œé…ç½®æ¯ä¸ªç±»å¯¹åº”çš„å®ç°ç±»ä»¬ã€‚</li>
<li>å…³äº SpringFactoriesLoader çš„è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬å°±ä¸å»ç»†çœ‹äº†ã€‚ğŸ˜ˆ å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬çœ‹æºç çš„æ—¶å€™ï¼Œä¸éœ€è¦é™·å…¥åˆ°æ¯ä¸ªæ–¹æ³•çš„ç»†èŠ‚ä¸­ã€‚éå…³é”®çš„æ–¹æ³•ï¼ŒçŒœæµ‹åˆ°å…·ä½“çš„ç”¨é€”åï¼Œè·³è¿‡ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ã€‚</li>
</ul>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#createSpringFactoriesInstances(Class&lt;T&gt; type, Class&lt;?&gt;[] parameterTypes, ClassLoader classLoader, Object[] args, Set&lt;String&gt; names)</code> æ–¹æ³•ï¼Œåˆ›å»ºå¯¹è±¡ä»¬ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºå¯¹è±¡çš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> type çˆ¶ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parameterTypes æ„é€ æ–¹æ³•çš„å‚æ•°ç±»å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> classLoader ç±»åŠ è½½å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> args å‚æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> names ç±»åçš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt; æ³›å‹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> å¯¹è±¡çš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">createSpringFactoriesInstances</span><span class="params">(Class&lt;T&gt; type,</span></span></span><br><span class="line"><span class="function"><span class="params">		Class&lt;?&gt;[] parameterTypes, ClassLoader classLoader, Object[] args,</span></span></span><br><span class="line"><span class="function"><span class="params">		Set&lt;String&gt; names)</span> </span>{</span><br><span class="line">	List&lt;T&gt; instances = <span class="keyword">new</span> ArrayList&lt;&gt;(names.size()); <span class="comment">// æ•°ç»„å¤§å°ï¼Œç»†èŠ‚~</span></span><br><span class="line">	<span class="comment">// éå† names æ•°ç»„</span></span><br><span class="line">	<span class="keyword">for</span> (String name : names) {</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			<span class="comment">// è·å¾— name å¯¹åº”çš„ç±»</span></span><br><span class="line">			Class&lt;?&gt; instanceClass = ClassUtils.forName(name, classLoader);</span><br><span class="line">			<span class="comment">// åˆ¤æ–­ç±»æ˜¯å¦å®ç°è‡ª type ç±»</span></span><br><span class="line">			Assert.isAssignable(type, instanceClass);</span><br><span class="line">			<span class="comment">// è·å¾—æ„é€ æ–¹æ³•</span></span><br><span class="line">			Constructor&lt;?&gt; constructor = instanceClass.getDeclaredConstructor(parameterTypes);</span><br><span class="line">			<span class="comment">// åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">			T instance = (T) BeanUtils.instantiateClass(constructor, args);</span><br><span class="line">			instances.add(instance);</span><br><span class="line">		} <span class="keyword">catch</span> (Throwable ex) {</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Cannot instantiate "</span> + type + <span class="string">" : "</span> + name, ex);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> instances;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ¯”è¾ƒç®€å•ï¼Œå°±ä¸å¤šåšè§£é‡Šäº†ã€‚</li>
</ul>
</li>
<li><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>AnnotationAwareOrderComparator#sort(List&lt;?&gt; list)</code> æ–¹æ³•ï¼Œæ’åºå¯¹è±¡ä»¬ã€‚ä¾‹å¦‚è¯´ï¼Œç±»ä¸Šæœ‰ <a href="https://www.jianshu.com/p/8442d21222ef" rel="external nofollow noopener noreferrer" target="_blank"><code>@Order</code></a> æ³¨è§£ã€‚</li>
</ul>
<h2 id="2-2-run"><a href="#2-2-run" class="headerlink" title="2.2 run"></a>2.2 run</h2><p><code>#run(String... args)</code> æ–¹æ³•ï¼Œè¿è¡Œ Spring åº”ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>è‰¿è‰¿ï¼šè¿™æ˜¯ä¸€ä¸ªé¥±æ»¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥é€»è¾‘æ¯”è¾ƒå¤šå“ˆã€‚</p>
</blockquote>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> ConfigurableApplicationContext <span class="title">run</span><span class="params">(String... args)</span> </span>{</span><br><span class="line">    <span class="comment">// &lt;1&gt; åˆ›å»º StopWatch å¯¹è±¡ï¼Œå¹¶å¯åŠ¨ã€‚StopWatch ä¸»è¦ç”¨äºç®€å•ç»Ÿè®¡ run å¯åŠ¨è¿‡ç¨‹çš„æ—¶é•¿ã€‚</span></span><br><span class="line">    StopWatch stopWatch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">    stopWatch.start();</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    ConfigurableApplicationContext context = <span class="keyword">null</span>;</span><br><span class="line">    Collection&lt;SpringBootExceptionReporter&gt; exceptionReporters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">// &lt;2&gt; é…ç½® headless å±æ€§</span></span><br><span class="line">    configureHeadlessProperty();</span><br><span class="line">    <span class="comment">// è·å¾— SpringApplicationRunListener çš„æ•°ç»„ï¼Œå¹¶å¯åŠ¨ç›‘å¬</span></span><br><span class="line">    SpringApplicationRunListeners listeners = getRunListeners(args);</span><br><span class="line">    listeners.starting();</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="comment">// &lt;3&gt; åˆ›å»º  ApplicationArguments å¯¹è±¡</span></span><br><span class="line">        ApplicationArguments applicationArguments = <span class="keyword">new</span> DefaultApplicationArguments(args);</span><br><span class="line">        <span class="comment">// &lt;4&gt; åŠ è½½å±æ€§é…ç½®ã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰€æœ‰çš„ environment çš„å±æ€§éƒ½ä¼šåŠ è½½è¿›æ¥ï¼ŒåŒ…æ‹¬ application.properties å’Œå¤–éƒ¨çš„å±æ€§é…ç½®ã€‚</span></span><br><span class="line">        ConfigurableEnvironment environment = prepareEnvironment(listeners, applicationArguments);</span><br><span class="line">        configureIgnoreBeanInfo(environment);</span><br><span class="line">        <span class="comment">// &lt;5&gt; æ‰“å° Spring Banner</span></span><br><span class="line">        Banner printedBanner = printBanner(environment);</span><br><span class="line">        <span class="comment">// &lt;6&gt; åˆ›å»º Spring å®¹å™¨ã€‚</span></span><br><span class="line">        context = createApplicationContext();</span><br><span class="line">        <span class="comment">// &lt;7&gt; å¼‚å¸¸æŠ¥å‘Šå™¨</span></span><br><span class="line">        exceptionReporters = getSpringFactoriesInstances(</span><br><span class="line">                SpringBootExceptionReporter.class,</span><br><span class="line">                <span class="keyword">new</span> Class[] { ConfigurableApplicationContext.class }, context);</span><br><span class="line">        <span class="comment">// &lt;8&gt; ä¸»è¦æ˜¯è°ƒç”¨æ‰€æœ‰åˆå§‹åŒ–ç±»çš„ initialize æ–¹æ³•</span></span><br><span class="line">        prepareContext(context, environment, listeners, applicationArguments,</span><br><span class="line">                printedBanner);</span><br><span class="line">        <span class="comment">// &lt;9&gt; åˆå§‹åŒ– Spring å®¹å™¨ã€‚</span></span><br><span class="line">        refreshContext(context);</span><br><span class="line">        <span class="comment">// &lt;10&gt; æ‰§è¡Œ Spring å®¹å™¨çš„åˆå§‹åŒ–çš„åç½®é€»è¾‘ã€‚é»˜è®¤å®ç°ä¸ºç©ºã€‚</span></span><br><span class="line">        afterRefresh(context, applicationArguments);</span><br><span class="line">        <span class="comment">// &lt;11&gt; åœæ­¢ StopWatch ç»Ÿè®¡æ—¶é•¿</span></span><br><span class="line">        stopWatch.stop();</span><br><span class="line">        <span class="comment">// &lt;12&gt; æ‰“å° Spring Boot å¯åŠ¨çš„æ—¶é•¿æ—¥å¿—ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) {</span><br><span class="line">            <span class="keyword">new</span> StartupInfoLogger(<span class="keyword">this</span>.mainApplicationClass).logStarted(getApplicationLog(), stopWatch);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// &lt;13&gt; é€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨å¯åŠ¨å®Œæˆã€‚</span></span><br><span class="line">        listeners.started(context);</span><br><span class="line">        <span class="comment">// &lt;14&gt; è°ƒç”¨ ApplicationRunner æˆ–è€… CommandLineRunner çš„è¿è¡Œæ–¹æ³•ã€‚</span></span><br><span class="line">        callRunners(context, applicationArguments);</span><br><span class="line">    } <span class="keyword">catch</span> (Throwable ex) {</span><br><span class="line">        <span class="comment">// &lt;14.1&gt; å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™è¿›è¡Œå¤„ç†ï¼Œå¹¶æŠ›å‡º IllegalStateException å¼‚å¸¸</span></span><br><span class="line">        handleRunFailure(context, ex, exceptionReporters, listeners);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// &lt;15&gt; é€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨è¿è¡Œä¸­ã€‚</span></span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        listeners.running(context);</span><br><span class="line">    } <span class="keyword">catch</span> (Throwable ex) {</span><br><span class="line">        <span class="comment">// &lt;15.1&gt; å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™è¿›è¡Œå¤„ç†ï¼Œå¹¶æŠ›å‡º IllegalStateException å¼‚å¸¸</span></span><br><span class="line">        handleRunFailure(context, ex, exceptionReporters, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> context;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œåˆ›å»º StopWatch å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ <code>StopWatch#run()</code> æ–¹æ³•æ¥å¯åŠ¨ã€‚StopWatch ä¸»è¦ç”¨äºç®€å•ç»Ÿè®¡ run å¯åŠ¨è¿‡ç¨‹çš„æ—¶é•¿ã€‚</li>
<li><code>&lt;2&gt;</code> å¤„ï¼Œé…ç½® headless å±æ€§ã€‚è¿™ä¸ªé€»è¾‘ï¼Œå¯ä»¥æ— è§†ï¼Œå’Œ AWT ç›¸å…³ã€‚</li>
<li><p><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#getRunListeners(String[] args)</code> æ–¹æ³•ï¼Œè·å¾— SpringApplicationRunListener æ•°ç»„ï¼Œå¹¶å¯åŠ¨ç›‘å¬ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> SpringApplicationRunListeners <span class="title">getRunListeners</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">	Class&lt;?&gt;[] types = <span class="keyword">new</span> Class&lt;?&gt;[] { SpringApplication.class, String[].class };</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> SpringApplicationRunListeners(logger, getSpringFactoriesInstances(</span><br><span class="line">			SpringApplicationRunListener.class, types, <span class="keyword">this</span>, args));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ­¤å¤„çš„ <code>listeners</code> å˜é‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<img src="http://static2.iocoder.cn/images/Spring-Boot/2021-01-07/03.jpg" alt="`listeners` å±æ€§"></li>
<li>æ³¨æ„å™¢ï¼Œæ­¤æ—¶æ˜¯ SpringApplication<strong>Run</strong>Listener ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬çœ‹åˆ° <code>listeners</code> çš„ ApplicationListener ç±»å‹ã€‚è¯¦ç»†çš„ï¼Œæˆ‘ä»¬åœ¨ <a href="#">ã€Œ3. SpringApplicationRunListenersã€</a> ä¸­ï¼Œåœ¨è¯¦ç»†è§£æã€‚</li>
</ul>
</li>
<li><p><code>&lt;4&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#prepareEnvironment(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</code> æ–¹æ³•ï¼ŒåŠ è½½å±æ€§é…ç½®ã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰€æœ‰çš„ environment çš„å±æ€§éƒ½ä¼šåŠ è½½è¿›æ¥ï¼ŒåŒ…æ‹¬ <code>application.properties</code> å’Œå¤–éƒ¨çš„å±æ€§é…ç½®ã€‚è¯¦ç»†çš„ï¼Œèƒ–å‹å…ˆä¸€èµ·è·³åˆ° <a href="#">ã€Œ2.2.1 prepareEnvironmentã€</a> ä¸­ã€‚</p>
</li>
<li><p><code>&lt;5&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#printBanner(ConfigurableEnvironment environment)</code> æ–¹æ³•ï¼Œæ‰“å° Spring Banner ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">  .   ____          _            __ _ _</span><br><span class="line"> /\\ / ___<span class="string">'_ __ _ _(_)_ __  __ _ \ \ \ \</span></span><br><span class="line"><span class="string">( ( )\___ | '</span>_ | <span class="string">'_| | '</span>_ \/ _` | \ \ \ \</span><br><span class="line"> \\/  ___)| |_)| | | | | || (_| |  ) ) ) )</span><br><span class="line">  <span class="string">'  |____| .__|_| |_|_| |_\__, | / / / /</span></span><br><span class="line"><span class="string"> =========|_|==============|___/=/_/_/_/</span></span><br><span class="line"><span class="string"> :: Spring Boot ::</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å…·ä½“çš„ä»£ç å®ç°ï¼Œå°±å…ˆä¸åˆ†æäº†ã€‚æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œè‡ªå·±å»ç…ç…ã€‚</li>
</ul>
</li>
<li><p><code>&lt;6&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#createApplicationContext()</code> æ–¹æ³•ï¼Œåˆ›å»º Spring å®¹å™¨ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.2.2 createApplicationContextã€</a> ã€‚</p>
</li>
<li><code>&lt;7&gt;</code> å¤„ï¼Œé€šè¿‡ <code>#getSpringFactoriesInstances(Class&lt;T&gt; type)</code> æ–¹æ³•ï¼Œè¿›è¡Œè·å¾— SpringBootExceptionReporter ç±»å‹çš„å¯¹è±¡æ•°ç»„ã€‚SpringBootExceptionReporter ï¼Œè®°å½•å¯åŠ¨è¿‡ç¨‹ä¸­çš„å¼‚å¸¸ä¿¡æ¯ã€‚<ul>
<li>æ­¤å¤„ï¼Œ<code>exceptionReporters</code> å±æ€§çš„ç»“æœå¦‚ä¸‹å›¾ï¼š<img src="http://static2.iocoder.cn/images/Spring-Boot/2021-01-07/04.jpg" alt="`listeners` å±æ€§"></li>
<li>å…³äº SpringBootExceptionReporter ï¼Œæ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œè‡ªå·±ç ”ç©¶å…ˆã€‚</li>
</ul>
</li>
<li><code>&lt;8&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#prepareContext(...)</code> æ–¹æ³•ï¼Œä¸»è¦æ˜¯è°ƒç”¨æ‰€æœ‰åˆå§‹åŒ–ç±»çš„ <code>#initialize(...)</code> æ–¹æ³•ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.2.3 prepareContextã€</a> ã€‚</li>
<li><code>&lt;9&gt;</code> å¤„ï¼Œè°ƒç”¨ <code></code>#refreshContext(ConfigurableApplicationContext context)` æ–¹æ³•ï¼Œå¯åŠ¨ï¼ˆåˆ·æ–°ï¼‰ Spring å®¹å™¨ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.2.4 refreshContextã€</a> ã€‚</li>
<li><p><code>&lt;10&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#afterRefresh(ConfigurableApplicationContext context, ApplicationArguments args)</code> æ–¹æ³•ï¼Œæ‰§è¡Œ Spring å®¹å™¨çš„åˆå§‹åŒ–çš„åç½®é€»è¾‘ã€‚<strong>é»˜è®¤å®ç°ä¸ºç©º</strong>ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterRefresh</span><span class="params">(ConfigurableApplicationContext context, ApplicationArguments args)</span> </span>{</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><code>&lt;11&gt;</code> å¤„ï¼Œåœæ­¢ StopWatch ç»Ÿè®¡æ—¶é•¿ã€‚</p>
</li>
<li><p><code>&lt;12&gt;</code> å¤„ï¼Œæ‰“å° Spring Boot å¯åŠ¨çš„æ—¶é•¿æ—¥å¿—ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">2019-01-28 20:42:03.338  INFO 53001 --- [           main] c.iocoder.springboot.mvc.MVCApplication  : Started MVCApplication <span class="keyword">in</span> 20.893 seconds (JVM running <span class="keyword">for</span> 23.536)</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><code>&lt;13&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringApplicationRunListeners#started(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œé€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨å¯åŠ¨å®Œæˆã€‚</p>
</li>
<li><code>&lt;14&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#callRunners(ApplicationContext context, ApplicationArguments args)</code> æ–¹æ³•ï¼Œè°ƒç”¨ ApplicationRunner æˆ–è€… CommandLineRunner çš„è¿è¡Œæ–¹æ³•ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.2.5 callRunnersã€</a> ã€‚<ul>
<li><code>&lt;14.1&gt;</code> å¤„ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™è°ƒç”¨ <code>#handleRunFailure(...)</code> æ–¹æ³•ï¼Œäº¤ç»™ SpringBootExceptionReporter è¿›è¡Œå¤„ç†ï¼Œå¹¶æŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚</li>
</ul>
</li>
<li><code>&lt;15&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringApplicationRunListeners#running(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œé€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨è¿è¡Œä¸­ã€‚<ul>
<li><code>&lt;15.1&gt;</code> å¤„ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™è°ƒç”¨ <code>#handleRunFailure(...)</code> æ–¹æ³•ï¼Œäº¤ç»™ SpringBootExceptionReporter è¿›è¡Œå¤„ç†ï¼Œå¹¶æŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚</li>
</ul>
</li>
</ul>
<h3 id="2-2-1-prepareEnvironment"><a href="#2-2-1-prepareEnvironment" class="headerlink" title="2.2.1 prepareEnvironment"></a>2.2.1 prepareEnvironment</h3><blockquote>
<p>è‰¿è‰¿ï¼šè¿™ä¸ªæ–¹æ³•ï¼Œå¤§ä½“çœ‹ä¸‹å³å¯ã€‚</p>
</blockquote>
<p><code>#prepareEnvironment(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</code> æ–¹æ³•ï¼ŒåŠ è½½å±æ€§é…ç½®ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> ConfigurableEnvironment <span class="title">prepareEnvironment</span><span class="params">(SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments)</span> </span>{</span><br><span class="line">	<span class="comment">// Create and configure the environment</span></span><br><span class="line">	<span class="comment">// &lt;1&gt; åˆ›å»º ConfigurableEnvironment å¯¹è±¡ï¼Œå¹¶è¿›è¡Œé…ç½®</span></span><br><span class="line">	ConfigurableEnvironment environment = getOrCreateEnvironment();</span><br><span class="line">	configureEnvironment(environment, applicationArguments.getSourceArgs());</span><br><span class="line">	<span class="comment">// &lt;2&gt; é€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼Œç¯å¢ƒå˜é‡å·²ç»å‡†å¤‡å®Œæˆã€‚</span></span><br><span class="line">	listeners.environmentPrepared(environment);</span><br><span class="line">	<span class="comment">// &lt;3&gt; ç»‘å®š environment åˆ° SpringApplication ä¸Š</span></span><br><span class="line">	bindToSpringApplication(environment);</span><br><span class="line">	<span class="comment">// &lt;4&gt; å¦‚æœéè‡ªå®šä¹‰ environment ï¼Œåˆ™æ ¹æ®æ¡ä»¶è½¬æ¢</span></span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">this</span>.isCustomEnvironment) {</span><br><span class="line">		environment = <span class="keyword">new</span> EnvironmentConverter(getClassLoader()).convertEnvironmentIfNecessary(environment, deduceEnvironmentClass());</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// &lt;5&gt; å¦‚æœæœ‰ attach åˆ° environment ä¸Šçš„ MutablePropertySources ï¼Œåˆ™æ·»åŠ åˆ° environment çš„ PropertySource ä¸­ã€‚</span></span><br><span class="line">	ConfigurationPropertySources.attach(environment);</span><br><span class="line">	<span class="keyword">return</span> environment;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#getOrCreateEnvironment()</code> æ–¹æ³•ï¼Œåˆ›å»º ConfigurableEnvironment å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> ConfigurableEnvironment <span class="title">getOrCreateEnvironment</span><span class="params">()</span> </span>{</span><br><span class="line">	<span class="comment">// å·²ç»å­˜åœ¨ï¼Œåˆ™è¿›è¡Œè¿”å›</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.environment != <span class="keyword">null</span>) {</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.environment;</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// ä¸å­˜åœ¨ï¼Œåˆ™æ ¹æ® webApplicationType ç±»å‹ï¼Œè¿›è¡Œåˆ›å»ºã€‚</span></span><br><span class="line">	<span class="keyword">switch</span> (<span class="keyword">this</span>.webApplicationType) {</span><br><span class="line">        <span class="keyword">case</span> SERVLET:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> StandardServletEnvironment();</span><br><span class="line">        <span class="keyword">case</span> REACTIVE:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> StandardReactiveWebEnvironment();</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> StandardEnvironment();</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ ¹æ® <code>webApplicationType</code> ç±»å‹ï¼Œä¼šåˆ›å»ºä¸åŒç±»å‹çš„ ConfigurableEnvironment å¯¹è±¡ã€‚</li>
<li>ä¾‹å¦‚è¯´ï¼ŒServlet éœ€è¦è€ƒè™‘ <code>&lt;servletContextInitParams /&gt;</code> å’Œ <code>&lt;servletConfigInitParams /&gt;</code> ç­‰é…ç½®å‚æ•°ã€‚</li>
</ul>
</li>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#configureEnvironment(ConfigurableEnvironment environment, String[] args)</code> æ–¹æ³•ï¼Œé…ç½® <code>environment</code> å˜é‡ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">   <span class="comment">// SpringApplication.java</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ˜¯å¦æ·»åŠ å…±äº«çš„ ConversionService</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> addConversionService = <span class="keyword">true</span>;</span><br><span class="line">   </span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configureEnvironment</span><span class="params">(ConfigurableEnvironment environment, String[] args)</span> </span>{</span><br><span class="line">   	<span class="comment">// &lt;1.1&gt; è®¾ç½® environment çš„ conversionService å±æ€§</span></span><br><span class="line">   	<span class="keyword">if</span> (<span class="keyword">this</span>.addConversionService) {</span><br><span class="line">   		ConversionService conversionService = ApplicationConversionService.getSharedInstance();</span><br><span class="line">   		environment.setConversionService((ConfigurableConversionService) conversionService);</span><br><span class="line">   	}</span><br><span class="line">   	<span class="comment">// &lt;1.2&gt; å¢åŠ  environment çš„ PropertySource å±æ€§æº</span></span><br><span class="line">   	configurePropertySources(environment, args);</span><br><span class="line">   	<span class="comment">// &lt;1.3&gt; é…ç½® environment çš„ activeProfiles å±æ€§</span></span><br><span class="line">   	configureProfiles(environment, args);</span><br><span class="line">   }</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1.1&gt;</code> å¤„ï¼Œè®¾ç½® <code>environment</code> çš„ <code>conversionService</code> å±æ€§ã€‚å¯ä»¥æš‚æ—¶æ— è§†ã€‚æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ <a href="http://svip.iocoder.cn/Spring/PropertySource-and-Environment-and-Profile/">ã€Šã€æ­»ç£• Springã€‘â€”â€” ç¯å¢ƒ &amp; å±æ€§ï¼šPropertySourceã€Environmentã€Profileã€‹</a></li>
<li><p><code>&lt;1.2&gt;</code> å¤„ï¼Œå¢åŠ  <code>environment</code> çš„ PropertySource å±æ€§æºã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line">   <span class="comment">// SpringApplication.java</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ˜¯å¦æ·»åŠ  JVM å¯åŠ¨å‚æ•°</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">boolean</span> addCommandLineProperties = <span class="keyword">true</span>;</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * é»˜è®¤çš„å±æ€§é›†åˆ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"><span class="keyword">private</span> Map&lt;String, Object&gt; defaultProperties;</span><br><span class="line">   </span><br><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configurePropertySources</span><span class="params">(ConfigurableEnvironment environment,</span></span></span><br><span class="line"><span class="function"><span class="params">   		String[] args)</span> </span>{</span><br><span class="line">   	MutablePropertySources sources = environment.getPropertySources();</span><br><span class="line">   	<span class="comment">// é…ç½®çš„ defaultProperties</span></span><br><span class="line">   	<span class="keyword">if</span> (<span class="keyword">this</span>.defaultProperties != <span class="keyword">null</span> &amp;&amp; !<span class="keyword">this</span>.defaultProperties.isEmpty()) {</span><br><span class="line">   		sources.addLast(<span class="keyword">new</span> MapPropertySource(<span class="string">"defaultProperties"</span>, <span class="keyword">this</span>.defaultProperties));</span><br><span class="line">   	}</span><br><span class="line">   	<span class="comment">// æ¥è‡ªå¯åŠ¨å‚æ•°çš„</span></span><br><span class="line">   	<span class="keyword">if</span> (<span class="keyword">this</span>.addCommandLineProperties &amp;&amp; args.length &gt; <span class="number">0</span>) {</span><br><span class="line">   		String name = CommandLinePropertySource.COMMAND_LINE_PROPERTY_SOURCE_NAME;</span><br><span class="line">   		<span class="keyword">if</span> (sources.contains(name)) { <span class="comment">// å·²å­˜åœ¨ï¼Œå°±è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">   			PropertySource&lt;?&gt; source = sources.get(name);</span><br><span class="line">   			CompositePropertySource composite = <span class="keyword">new</span> CompositePropertySource(name);</span><br><span class="line">   			composite.addPropertySource(<span class="keyword">new</span> SimpleCommandLinePropertySource(</span><br><span class="line">   					<span class="string">"springApplicationCommandLineArgs"</span>, args));</span><br><span class="line">   			composite.addPropertySource(source);</span><br><span class="line">   			sources.replace(name, composite);</span><br><span class="line">   		} <span class="keyword">else</span> { <span class="comment">// ä¸å­˜åœ¨ï¼Œå°±è¿›è¡Œæ·»åŠ </span></span><br><span class="line">   			sources.addFirst(<span class="keyword">new</span> SimpleCommandLinePropertySource(args));</span><br><span class="line">   		}</span><br><span class="line">   	}</span><br><span class="line">   }</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä»£ç ä¸Šå¯ä»¥çœ‹å‡ºï¼Œå¯ä»¥æ ¹æ®é…ç½®çš„ <code>defaultProperties</code>ã€æˆ–è€… JVM å¯åŠ¨å‚æ•°ï¼Œä½œä¸ºé™„åŠ çš„ PropertySource å±æ€§æºã€‚</li>
</ul>
</li>
<li><p><code>&lt;1.3&gt;</code> å¤„ï¼Œé…ç½® <code>environment</code> çš„ <code>activeProfiles</code> å±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é™„åŠ çš„ profiles çš„æ•°ç»„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Set&lt;String&gt; additionalProfiles = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configureProfiles</span><span class="params">(ConfigurableEnvironment environment, String[] args)</span> </span>{</span><br><span class="line">	environment.getActiveProfiles(); <span class="comment">// ensure they are initialized ä¿è¯å·²ç»è¢«åˆå§‹åŒ–</span></span><br><span class="line">	<span class="comment">// But these ones should go first (last wins in a property key clash)</span></span><br><span class="line">	Set&lt;String&gt; profiles = <span class="keyword">new</span> LinkedHashSet&lt;&gt;(<span class="keyword">this</span>.additionalProfiles);</span><br><span class="line">	profiles.addAll(Arrays.asList(environment.getActiveProfiles()));</span><br><span class="line">	<span class="comment">// è®¾ç½® activeProfiles</span></span><br><span class="line">	environment.setActiveProfiles(StringUtils.toStringArray(profiles));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä¸äº†è§£ Profile çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ <a href="https://my.oschina.net/u/1469495/blog/1522784" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring Boot æ¿€æ´» profile çš„å‡ ç§æ–¹å¼ã€‹</a> æ–‡ç« ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringApplicationRunListeners#environmentPrepared(ConfigurableEnvironment environment)</code> æ–¹æ³•ï¼Œé€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼Œç¯å¢ƒå˜é‡å·²ç»å‡†å¤‡å®Œæˆã€‚</p>
</li>
<li><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#bindToSpringApplication(ConfigurableEnvironment environment)</code> æ–¹æ³•ï¼Œç»‘å®š <code>environment</code> åˆ° SpringApplication ä¸Šã€‚æš‚æ—¶ä¸å¤ªçŸ¥é“ç”¨é€”ã€‚</li>
<li><code>&lt;4&gt;</code> å¤„ï¼Œå¦‚æœéè‡ªå®šä¹‰ <code>environment</code> ï¼Œåˆ™æ ¹æ®æ¡ä»¶è½¬æ¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>isCustomEnvironment</code> ä¸º <code>false</code> ï¼Œæ‰€ä»¥ä¼šæ‰§è¡Œè¿™å—é€»è¾‘ã€‚ä½†æ˜¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿”å›çš„è¿˜æ˜¯ <code>environment</code> è‡ªèº«ï¼Œæ‰€ä»¥å¯ä»¥æ— è§†è¿™å—é€»è¾‘å…ˆã€‚</li>
<li><code>&lt;5&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>ConfigurationPropertySources#attach(Environment environment)</code> <strong>é™æ€</strong>æ–¹æ³•ï¼Œå¦‚æœæœ‰ attach åˆ° <code>environment</code>ä¸Šçš„ MutablePropertySources ï¼Œåˆ™æ·»åŠ åˆ° <code>environment</code> çš„ PropertySource ä¸­ã€‚è¿™å—é€»è¾‘ï¼Œä¹Ÿå¯ä»¥å…ˆæ— è§†ã€‚</li>
</ul>
<h3 id="2-2-2-createApplicationContext"><a href="#2-2-2-createApplicationContext" class="headerlink" title="2.2.2 createApplicationContext"></a>2.2.2 createApplicationContext</h3><p><code>#createApplicationContext()</code> æ–¹æ³•ï¼Œåˆ›å»º Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class name of application context that will be used by default for non-web</span></span><br><span class="line"><span class="comment"> * environments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_CONTEXT_CLASS = <span class="string">"org.springframework.context."</span></span><br><span class="line">		+ <span class="string">"annotation.AnnotationConfigApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class name of application context that will be used by default for web</span></span><br><span class="line"><span class="comment"> * environments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = <span class="string">"org.springframework.boot."</span></span><br><span class="line">		+ <span class="string">"web.servlet.context.AnnotationConfigServletWebServerApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class name of application context that will be used by default for reactive web</span></span><br><span class="line"><span class="comment"> * environments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class="string">"org.springframework."</span></span><br><span class="line">		+ <span class="string">"boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> ConfigurableApplicationContext <span class="title">createApplicationContext</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// æ ¹æ® webApplicationType ç±»å‹ï¼Œè·å¾— ApplicationContext ç±»å‹</span></span><br><span class="line">	Class&lt;?&gt; contextClass = <span class="keyword">this</span>.applicationContextClass;</span><br><span class="line">	<span class="keyword">if</span> (contextClass == <span class="keyword">null</span>) {</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			<span class="keyword">switch</span> (<span class="keyword">this</span>.webApplicationType) {</span><br><span class="line">			<span class="keyword">case</span> SERVLET:</span><br><span class="line">				contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> REACTIVE:</span><br><span class="line">				contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class="line">			}</span><br><span class="line">		} <span class="keyword">catch</span> (ClassNotFoundException ex) {</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Unable create a default ApplicationContext, "</span> + <span class="string">"please specify an ApplicationContextClass"</span>, ex);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// åˆ›å»º ApplicationContext å¯¹è±¡</span></span><br><span class="line">	<span class="keyword">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æ ¹æ® <code>webApplicationType</code> ç±»å‹ï¼Œè·å¾—å¯¹åº”çš„ ApplicationContext å¯¹è±¡ã€‚</li>
</ul>
<h3 id="2-2-3-prepareContext"><a href="#2-2-3-prepareContext" class="headerlink" title="2.2.3 prepareContext"></a>2.2.3 prepareContext</h3><p><code>#prepareContext(ConfigurableApplicationContext context, ConfigurableEnvironment environment, SpringApplicationRunListeners listeners, ApplicationArguments applicationArguments, Banner printedBanner)</code> æ–¹æ³•ï¼Œå‡†å¤‡ ApplicationContext å¯¹è±¡ï¼Œä¸»è¦æ˜¯åˆå§‹åŒ–å®ƒçš„ä¸€äº›å±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">prepareContext</span><span class="params">(ConfigurableApplicationContext context,</span></span></span><br><span class="line"><span class="function"><span class="params">        ConfigurableEnvironment environment, SpringApplicationRunListeners listeners,</span></span></span><br><span class="line"><span class="function"><span class="params">        ApplicationArguments applicationArguments, Banner printedBanner)</span> </span>{</span><br><span class="line">    <span class="comment">// &lt;1&gt; è®¾ç½® context çš„ environment å±æ€§</span></span><br><span class="line">    context.setEnvironment(environment);</span><br><span class="line">    <span class="comment">// &lt;2&gt; è®¾ç½® context çš„ä¸€äº›å±æ€§</span></span><br><span class="line">    postProcessApplicationContext(context);</span><br><span class="line">    <span class="comment">// &lt;3&gt; åˆå§‹åŒ– ApplicationContextInitializer</span></span><br><span class="line">    applyInitializers(context);</span><br><span class="line">    <span class="comment">// &lt;4&gt; é€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨å‡†å¤‡å®Œæˆã€‚</span></span><br><span class="line">    listeners.contextPrepared(context);</span><br><span class="line">    <span class="comment">// &lt;5&gt; æ‰“å°æ—¥å¿—</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.logStartupInfo) {</span><br><span class="line">        logStartupInfo(context.getParent() == <span class="keyword">null</span>);</span><br><span class="line">        logStartupProfileInfo(context);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// Add boot specific singleton beans</span></span><br><span class="line">    <span class="comment">// &lt;6&gt; è®¾ç½® beanFactory çš„å±æ€§</span></span><br><span class="line">    ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class="line">    beanFactory.registerSingleton(<span class="string">"springApplicationArguments"</span>, applicationArguments);</span><br><span class="line">    <span class="keyword">if</span> (printedBanner != <span class="keyword">null</span>) {</span><br><span class="line">        beanFactory.registerSingleton(<span class="string">"springBootBanner"</span>, printedBanner);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (beanFactory <span class="keyword">instanceof</span> DefaultListableBeanFactory) {</span><br><span class="line">        ((DefaultListableBeanFactory) beanFactory).setAllowBeanDefinitionOverriding(<span class="keyword">this</span>.allowBeanDefinitionOverriding);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// Load the sources</span></span><br><span class="line">    <span class="comment">// &lt;7&gt; åŠ è½½ BeanDefinition ä»¬</span></span><br><span class="line">    Set&lt;Object&gt; sources = getAllSources();</span><br><span class="line">    Assert.notEmpty(sources, <span class="string">"Sources must not be empty"</span>);</span><br><span class="line">    load(context, sources.toArray(<span class="keyword">new</span> Object[<span class="number">0</span>]));</span><br><span class="line">    <span class="comment">// &lt;8&gt; é€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨åŠ è½½å®Œæˆã€‚</span></span><br><span class="line">    listeners.contextLoaded(context);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>è¿™ä¸ªæ–¹æ³•ï¼Œè¿˜æ˜¯è›®é•¿çš„ï¼Œä¸»è¦æ˜¯ç»™ <code>context</code> çš„å±æ€§åšèµ‹å€¼ï¼Œä»¥åŠ ApplicationContextInitializer çš„åˆå§‹åŒ–ã€‚</li>
<li><code>&lt;1&gt;</code> å¤„ï¼Œè®¾ç½® <code>context</code> çš„ <code>environment</code> å±æ€§ã€‚</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#postProcessApplicationContext(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œè®¾ç½® <code>context</code> çš„ä¸€äº›å±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postProcessApplicationContext</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.beanNameGenerator != <span class="keyword">null</span>) {</span><br><span class="line">		context.getBeanFactory().registerSingleton(AnnotationConfigUtils.CONFIGURATION_BEAN_NAME_GENERATOR, <span class="keyword">this</span>.beanNameGenerator);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.resourceLoader != <span class="keyword">null</span>) {</span><br><span class="line">		<span class="keyword">if</span> (context <span class="keyword">instanceof</span> GenericApplicationContext) {</span><br><span class="line">			((GenericApplicationContext) context).setResourceLoader(<span class="keyword">this</span>.resourceLoader);</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">if</span> (context <span class="keyword">instanceof</span> DefaultResourceLoader) {</span><br><span class="line">			((DefaultResourceLoader) context).setClassLoader(<span class="keyword">this</span>.resourceLoader.getClassLoader());</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.addConversionService) {</span><br><span class="line">		context.getBeanFactory().setConversionService(ApplicationConversionService.getSharedInstance());</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#applyInitializers(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œåˆå§‹åŒ– ApplicationContextInitializer ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">applyInitializers</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">	<span class="comment">// éå† ApplicationContextInitializer æ•°ç»„</span></span><br><span class="line">	<span class="keyword">for</span> (ApplicationContextInitializer initializer : getInitializers()) {</span><br><span class="line">	    <span class="comment">// æ ¡éªŒ ApplicationContextInitializer çš„æ³›å‹éç©º</span></span><br><span class="line">		Class&lt;?&gt; requiredType = GenericTypeResolver.resolveTypeArgument(</span><br><span class="line">				initializer.getClass(), ApplicationContextInitializer.class);</span><br><span class="line">		Assert.isInstanceOf(requiredType, context, <span class="string">"Unable to call initializer."</span>);</span><br><span class="line">		<span class="comment">// åˆå§‹åŒ– ApplicationContextInitializer</span></span><br><span class="line">		initializer.initialize(context);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>éå† ApplicationContextInitializer æ•°ç»„ï¼Œé€ä¸ªè°ƒç”¨ <code>ApplicationContextInitializer#initialize(context)</code> æ–¹æ³•ï¼Œè¿›è¡Œåˆå§‹åŒ–ã€‚</li>
</ul>
</li>
<li><code>&lt;4&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringApplicationRunListeners#contextPrepared(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œé€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨å‡†å¤‡å®Œæˆã€‚</li>
<li><p><code>&lt;5&gt;</code> å¤„ï¼Œæ‰“å°æ—¥å¿—ã€‚æ•ˆæœå¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">2019-01-28 17:53:31.600  INFO 21846 --- [           main] c.iocoder.springboot.mvc.MVCApplication  : Starting MVCApplication on MacBook-Pro-5.local with PID 21846 (/Users/yunai/Java/spring-boot/spring-boot-tests/spring-boot-yunai-tests/spring-boot-yunai-mvc-tests/target/classes started by yunai <span class="keyword">in</span> /Users/yunai/Java/spring-boot)</span><br><span class="line">2019-01-28 17:53:40.028  INFO 21846 --- [           main] c.iocoder.springboot.mvc.MVCApplication  : The following profiles are active: prod</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å…·ä½“çš„æ–¹æ³•é€»è¾‘ï¼Œèƒ–å‹è‡ªå·±ç…ç…å“ˆã€‚</li>
</ul>
</li>
<li><p><code>&lt;6&gt;</code> å¤„ï¼Œè®¾ç½® <code>beanFactory</code> çš„å±æ€§ã€‚</p>
</li>
<li><p><code>&lt;7&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#load(ApplicationContext context, Object[] sources)</code> æ–¹æ³•ï¼ŒåŠ è½½ BeanDefinition ä»¬ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(ApplicationContext context, Object[] sources)</span> </span>{</span><br><span class="line">	<span class="keyword">if</span> (logger.isDebugEnabled()) {</span><br><span class="line">		logger.debug(<span class="string">"Loading source "</span> + StringUtils.arrayToCommaDelimitedString(sources));</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// &lt;1&gt; åˆ›å»º BeanDefinitionLoader å¯¹è±¡</span></span><br><span class="line">	BeanDefinitionLoader loader = createBeanDefinitionLoader(getBeanDefinitionRegistry(context), sources);</span><br><span class="line">	<span class="comment">// &lt;2&gt; è®¾ç½® loader çš„å±æ€§</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.beanNameGenerator != <span class="keyword">null</span>) {</span><br><span class="line">		loader.setBeanNameGenerator(<span class="keyword">this</span>.beanNameGenerator);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.resourceLoader != <span class="keyword">null</span>) {</span><br><span class="line">		loader.setResourceLoader(<span class="keyword">this</span>.resourceLoader);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.environment != <span class="keyword">null</span>) {</span><br><span class="line">		loader.setEnvironment(<span class="keyword">this</span>.environment);</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// &lt;3&gt; æ‰§è¡Œ BeanDefinition åŠ è½½</span></span><br><span class="line">	loader.load();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#getBeanDefinitionRegistry(ApplicationContext context)</code> æ–¹æ³•ï¼Œåˆ›å»º BeanDefinitionRegistry å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> BeanDefinitionRegistry <span class="title">getBeanDefinitionRegistry</span><span class="params">(ApplicationContext context)</span> </span>{</span><br><span class="line">	<span class="keyword">if</span> (context <span class="keyword">instanceof</span> BeanDefinitionRegistry) {</span><br><span class="line">		<span class="keyword">return</span> (BeanDefinitionRegistry) context;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span> (context <span class="keyword">instanceof</span> AbstractApplicationContext) {</span><br><span class="line">		<span class="keyword">return</span> (BeanDefinitionRegistry) ((AbstractApplicationContext) context)</span><br><span class="line">				.getBeanFactory();</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Could not locate BeanDefinitionRegistry"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å…³äº BeanDefinitionRegistry ç±»ï¼Œæš‚æ—¶ä¸éœ€è¦æ·±å…¥äº†è§£ã€‚æ„Ÿå…´è¶£çš„èƒ–å‹ï¼Œå¯ä»¥çœ‹çœ‹ <a href="http://svip.iocoder.cn/Spring/IoC-BeanDefinitionRegistry/">ã€Šã€æ­»ç£• Springã€‘â€”â€” IoC ä¹‹ BeanDefinition æ³¨å†Œè¡¨ï¼šBeanDefinitionRegistryã€‹</a> æ–‡ç« ã€‚</li>
</ul>
</li>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#createBeanDefinitionLoader(BeanDefinitionRegistry registry, Object[] sources)</code> æ–¹æ³•ï¼Œåˆ›å»º <code>org.springframework.boot.BeanDefinitionLoader</code> å¯¹è±¡ã€‚å…³äºå®ƒï¼Œåç»­çš„æ–‡ç« ï¼Œè¯¦ç»†è§£æã€‚</p>
</li>
<li><code>&lt;2&gt;</code> å¤„ï¼Œè®¾ç½® <code>loader</code> çš„å±æ€§ã€‚ </li>
<li><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>BeanDefinitionLoader#load()</code> æ–¹æ³•ï¼Œæ‰§è¡Œ BeanDefinition åŠ è½½ã€‚å…³äºè¿™ä¸€å—ï¼Œèƒ–å‹æ„Ÿå…´è¶£ï¼Œå…ˆç®€å•çœ‹çœ‹ <a href="http://svip.iocoder.cn/Spring/IoC-load-BeanDefinitions/">ã€Šã€æ­»ç£• Springã€‘â€”â€” IoC ä¹‹åŠ è½½ BeanDefinitionã€‹</a> æ–‡ç« ã€‚ </li>
</ul>
</li>
<li><p><code>&lt;8&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>SpringApplicationRunListeners#contextLoaded(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œé€šçŸ¥ SpringApplicationRunListener çš„æ•°ç»„ï¼ŒSpring å®¹å™¨åŠ è½½å®Œæˆã€‚</p>
</li>
</ul>
<h3 id="2-2-4-refreshContext"><a href="#2-2-4-refreshContext" class="headerlink" title="2.2.4 refreshContext"></a>2.2.4 refreshContext</h3><p><code>#refreshContext(ConfigurableApplicationContext context)</code> æ–¹æ³•ï¼Œå¯åŠ¨ï¼ˆåˆ·æ–°ï¼‰ Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ˜¯å¦æ³¨å†Œ ShutdownHook é’©å­</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> registerShutdownHook = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refreshContext</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">	<span class="comment">// &lt;1&gt; å¼€å¯ï¼ˆåˆ·æ–°ï¼‰Spring å®¹å™¨</span></span><br><span class="line">	refresh(context);</span><br><span class="line">	<span class="comment">// &lt;2&gt; æ³¨å†Œ ShutdownHook é’©å­</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">this</span>.registerShutdownHook) {</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			context.registerShutdownHook();</span><br><span class="line">		} <span class="keyword">catch</span> (AccessControlException ex) {</span><br><span class="line">			<span class="comment">// Not allowed in some environments.</span></span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#refresh(ApplicationContext applicationContext)</code> æ–¹æ³•ï¼Œå¼€å¯ï¼ˆåˆ·æ–°ï¼‰Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">(ApplicationContext applicationContext)</span> </span>{</span><br><span class="line">	<span class="comment">// æ–­è¨€ï¼Œåˆ¤æ–­ applicationContext æ˜¯ AbstractApplicationContext çš„å­ç±»</span></span><br><span class="line">	Assert.isInstanceOf(AbstractApplicationContext.class, applicationContext);</span><br><span class="line">	<span class="comment">// å¯åŠ¨ï¼ˆåˆ·æ–°ï¼‰ AbstractApplicationContext</span></span><br><span class="line">	((AbstractApplicationContext) applicationContext).refresh();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>è°ƒç”¨ <code>AbstractApplicationContext#refresh()</code> æ–¹æ³•ï¼Œå¯åŠ¨ï¼ˆåˆ·æ–°ï¼‰Spring å®¹å™¨ã€‚<ul>
<li><code>AbstractApplicationContext#refresh()</code> æ–¹æ³•ï¼Œèƒ–å‹å¯ä»¥çœ‹çœ‹ <a href="http://svip.iocoder.cn/Spring/ApplicationContext/">ã€Šã€æ­»ç£• Springã€‘â€”â€” ApplicationContext ç›¸å…³æ¥å£æ¶æ„åˆ†æã€‹</a> æ–‡ç« ã€‚</li>
<li>è¿™é‡Œï¼Œå¯ä»¥è§¦å‘ Spring Boot çš„è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ã€‚å…³äºè¿™ä¸€å—ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ï¼Œè¯¦ç»†è§£æã€‚</li>
</ul>
</li>
</ul>
</li>
<li><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>ConfigurableApplicationContext#registerShutdownHook()</code> æ–¹æ³•ï¼Œæ³¨å†Œ ShutdownHook é’©å­ã€‚è¿™ä¸ªé’©å­ï¼Œä¸»è¦ç”¨äº Spring åº”ç”¨çš„å…³é—­æ—¶ï¼Œé”€æ¯ç›¸åº”çš„ Bean ä»¬ã€‚</li>
</ul>
<h3 id="2-2-5-callRunners"><a href="#2-2-5-callRunners" class="headerlink" title="2.2.5 callRunners"></a>2.2.5 callRunners</h3><p><code>#callRunners(ApplicationContext context, ApplicationArguments args)</code> æ–¹æ³•ï¼Œè°ƒç”¨ ApplicationRunner æˆ–è€… CommandLineRunner çš„è¿è¡Œæ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callRunners</span><span class="params">(ApplicationContext context, ApplicationArguments args)</span> </span>{</span><br><span class="line">    <span class="comment">// &lt;1&gt; è·å¾—æ‰€æœ‰ Runner ä»¬</span></span><br><span class="line">    List&lt;Object&gt; runners = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">// &lt;1.1&gt; è·å¾—æ‰€æœ‰ ApplicationRunner Bean ä»¬</span></span><br><span class="line">    runners.addAll(context.getBeansOfType(ApplicationRunner.class).values());</span><br><span class="line">    <span class="comment">// &lt;1.2&gt; è·å¾—æ‰€æœ‰ CommandLineRunner Bean ä»¬</span></span><br><span class="line">    runners.addAll(context.getBeansOfType(CommandLineRunner.class).values());</span><br><span class="line">    <span class="comment">// &lt;1.3&gt; æ’åº runners</span></span><br><span class="line">    AnnotationAwareOrderComparator.sort(runners);</span><br><span class="line">    <span class="comment">// &lt;2&gt; éå† Runner æ•°ç»„ï¼Œæ‰§è¡Œé€»è¾‘</span></span><br><span class="line">    <span class="keyword">for</span> (Object runner : <span class="keyword">new</span> LinkedHashSet&lt;&gt;(runners)) {</span><br><span class="line">        <span class="keyword">if</span> (runner <span class="keyword">instanceof</span> ApplicationRunner) {</span><br><span class="line">            callRunner((ApplicationRunner) runner, args);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (runner <span class="keyword">instanceof</span> CommandLineRunner) {</span><br><span class="line">            callRunner((CommandLineRunner) runner, args);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œè·å¾—æ‰€æœ‰ Runner ä»¬ï¼Œå¹¶è¿›è¡Œæ’åºã€‚</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œéå† Runner æ•°ç»„ï¼Œæ‰§è¡Œé€»è¾‘ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callRunner</span><span class="params">(ApplicationRunner runner, ApplicationArguments args)</span> </span>{</span><br><span class="line">	<span class="keyword">try</span> {</span><br><span class="line">		(runner).run(args);</span><br><span class="line">	} <span class="keyword">catch</span> (Exception ex) {</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Failed to execute ApplicationRunner"</span>, ex);</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callRunner</span><span class="params">(CommandLineRunner runner, ApplicationArguments args)</span> </span>{</span><br><span class="line">	<span class="keyword">try</span> {</span><br><span class="line">		(runner).run(args.getSourceArgs());</span><br><span class="line">	} <span class="keyword">catch</span> (Exception ex) {</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Failed to execute CommandLineRunner"</span>, ex);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<p>å…³äº Runner åŠŸèƒ½çš„ä½¿ç”¨ï¼Œå¯ä»¥çœ‹çœ‹ <a href="https://www.kancloud.cn/letiantian/learn-spring-boot/697172" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠApplicationRunner æ¥å£ã€‹</a> å’Œ <a href="https://www.kancloud.cn/letiantian/learn-spring-boot/696203" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠCommandLineRunner æ¥å£ã€‹</a> æ–‡æ¡£ã€‚</p>
<h1 id="3-SpringApplicationRunListeners"><a href="#3-SpringApplicationRunListeners" class="headerlink" title="3. SpringApplicationRunListeners"></a>3. SpringApplicationRunListeners</h1><p><code>org.springframework.boot.SpringApplicationRunListeners</code> ï¼ŒSpringApplicationRunListener æ•°ç»„çš„å°è£…ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplicationRunListeners.java</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringApplicationRunListeners</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Log log;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * SpringApplicationRunListener æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> List&lt;SpringApplicationRunListener&gt; listeners;</span><br><span class="line"></span><br><span class="line">    SpringApplicationRunListeners(Log log,</span><br><span class="line">            Collection&lt;? extends SpringApplicationRunListener&gt; listeners) {</span><br><span class="line">        <span class="keyword">this</span>.log = log;</span><br><span class="line">        <span class="keyword">this</span>.listeners = <span class="keyword">new</span> ArrayList&lt;&gt;(listeners);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">starting</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            listener.starting();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            listener.environmentPrepared(environment);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            listener.contextPrepared(context);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            listener.contextLoaded(context);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">started</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            listener.started(context);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">running</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            listener.running(context);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (SpringApplicationRunListener listener : <span class="keyword">this</span>.listeners) {</span><br><span class="line">            callFailedListener(listener, context, exception);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callFailedListener</span><span class="params">(SpringApplicationRunListener listener, ConfigurableApplicationContext context, Throwable exception)</span> </span>{</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            listener.failed(context, exception);</span><br><span class="line">        } <span class="keyword">catch</span> (Throwable ex) {</span><br><span class="line">            <span class="keyword">if</span> (exception == <span class="keyword">null</span>) {</span><br><span class="line">                ReflectionUtils.rethrowRuntimeException(ex);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>.log.isDebugEnabled()) {</span><br><span class="line">                <span class="keyword">this</span>.log.error(<span class="string">"Error handling failed"</span>, ex);</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                String message = ex.getMessage();</span><br><span class="line">                message = (message != <span class="keyword">null</span>) ? message : <span class="string">"no error message"</span>;</span><br><span class="line">                <span class="keyword">this</span>.log.warn(<span class="string">"Error handling failed ("</span> + message + <span class="string">")"</span>);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="3-1-SpringApplicationRunListener"><a href="#3-1-SpringApplicationRunListener" class="headerlink" title="3.1 SpringApplicationRunListener"></a>3.1 SpringApplicationRunListener</h2><p><code>org.springframework.boot.SpringApplicationRunListener</code> ï¼ŒSpringApplication è¿è¡Œçš„ç›‘å¬å™¨æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplicationRunListener.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SpringApplicationRunListener</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Called immediately when the run method has first started. Can be used for very</span></span><br><span class="line"><span class="comment">	 * early initialization.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">starting</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Called once the environment has been prepared, but before the</span></span><br><span class="line"><span class="comment">	 * {<span class="doctag">@link</span> ApplicationContext} has been created.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> environment the environment</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Called once the {<span class="doctag">@link</span> ApplicationContext} has been created and prepared, but</span></span><br><span class="line"><span class="comment">	 * before sources have been loaded.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> context the application context</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Called once the application context has been loaded but before it has been</span></span><br><span class="line"><span class="comment">	 * refreshed.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> context the application context</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * The context has been refreshed and the application has started but</span></span><br><span class="line"><span class="comment">	 * {<span class="doctag">@link</span> CommandLineRunner CommandLineRunners} and {<span class="doctag">@link</span> ApplicationRunner</span></span><br><span class="line"><span class="comment">	 * ApplicationRunners} have not been called.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> context the application context.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@since</span> 2.0.0</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">started</span><span class="params">(ConfigurableApplicationContext context)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Called immediately before the run method finishes, when the application context has</span></span><br><span class="line"><span class="comment">	 * been refreshed and all {<span class="doctag">@link</span> CommandLineRunner CommandLineRunners} and</span></span><br><span class="line"><span class="comment">	 * {<span class="doctag">@link</span> ApplicationRunner ApplicationRunners} have been called.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> context the application context.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@since</span> 2.0.0</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">running</span><span class="params">(ConfigurableApplicationContext context)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Called when a failure occurs when running the application.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> context the application context or {<span class="doctag">@code</span> null} if a failure occurred before</span></span><br><span class="line"><span class="comment">	 * the context was created</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> exception the failure</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@since</span> 2.0.0</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ç›®å‰ï¼ŒSpringApplicationRunListener çš„å®ç°ç±»ï¼Œåªæœ‰ EventPublishingRunListener ç±»ã€‚</p>
<h2 id="3-2-EventPublishingRunListener"><a href="#3-2-EventPublishingRunListener" class="headerlink" title="3.2 EventPublishingRunListener"></a>3.2 EventPublishingRunListener</h2><p><code>org.springframework.boot.context.event.EventPublishingRunListener</code> ï¼Œå®ç° SpringApplicationRunListenerã€Ordered æ¥å£ï¼Œå°† SpringApplicationRunListener ç›‘å¬åˆ°çš„äº‹ä»¶ï¼Œè½¬æ¢æˆå¯¹åº”çš„ SpringApplicationEvent äº‹ä»¶ï¼Œå‘å¸ƒåˆ°ç›‘å¬å™¨ä»¬ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// EventPublishingRunListener.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EventPublishingRunListener</span> <span class="keyword">implements</span> <span class="title">SpringApplicationRunListener</span>, <span class="title">Ordered</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Spring åº”ç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> SpringApplication application;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‚æ•°é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String[] args;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº‹ä»¶å¹¿æ’­å™¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> SimpleApplicationEventMulticaster initialMulticaster;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EventPublishingRunListener</span><span class="params">(SpringApplication application, String[] args)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.application = application;</span><br><span class="line">        <span class="keyword">this</span>.args = args;</span><br><span class="line">        <span class="comment">// åˆ›å»º SimpleApplicationEventMulticaster å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">this</span>.initialMulticaster = <span class="keyword">new</span> SimpleApplicationEventMulticaster();</span><br><span class="line">        <span class="comment">// æ·»åŠ åº”ç”¨çš„ç›‘å¬å™¨ä»¬ï¼Œåˆ° initialMulticaster ä¸­</span></span><br><span class="line">        <span class="keyword">for</span> (ApplicationListener&lt;?&gt; listener : application.getListeners()) {</span><br><span class="line">            <span class="keyword">this</span>.initialMulticaster.addApplicationListener(listener);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">starting</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.initialMulticaster.multicastEvent(<span class="keyword">new</span> ApplicationStartingEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// ApplicationEnvironmentPreparedEvent</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">environmentPrepared</span><span class="params">(ConfigurableEnvironment environment)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.initialMulticaster.multicastEvent(<span class="keyword">new</span> ApplicationEnvironmentPreparedEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args, environment));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// ApplicationContextInitializedEvent</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextPrepared</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        <span class="keyword">this</span>.initialMulticaster.multicastEvent(<span class="keyword">new</span> ApplicationContextInitializedEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args, context));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// ApplicationPreparedEvent</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoaded</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        <span class="keyword">for</span> (ApplicationListener&lt;?&gt; listener : <span class="keyword">this</span>.application.getListeners()) {</span><br><span class="line">            <span class="keyword">if</span> (listener <span class="keyword">instanceof</span> ApplicationContextAware) {</span><br><span class="line">                ((ApplicationContextAware) listener).setApplicationContext(context);</span><br><span class="line">            }</span><br><span class="line">            context.addApplicationListener(listener);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">this</span>.initialMulticaster.multicastEvent(<span class="keyword">new</span> ApplicationPreparedEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args, context));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// ApplicationStartedEvent</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">started</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> ApplicationStartedEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args, context));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">running</span><span class="params">(ConfigurableApplicationContext context)</span> </span>{</span><br><span class="line">        context.publishEvent(<span class="keyword">new</span> ApplicationReadyEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args, context));</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// ApplicationFailedEvent</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">failed</span><span class="params">(ConfigurableApplicationContext context, Throwable exception)</span> </span>{</span><br><span class="line">        ApplicationFailedEvent event = <span class="keyword">new</span> ApplicationFailedEvent(<span class="keyword">this</span>.application, <span class="keyword">this</span>.args, context, exception);</span><br><span class="line">        <span class="keyword">if</span> (context != <span class="keyword">null</span> &amp;&amp; context.isActive()) {</span><br><span class="line">            <span class="comment">// Listeners have been registered to the application context so we should</span></span><br><span class="line">            <span class="comment">// use it at this point if we can</span></span><br><span class="line">            context.publishEvent(event);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="comment">// An inactive context may not have a multicaster so we use our multicaster to</span></span><br><span class="line">            <span class="comment">// call all of the context's listeners instead</span></span><br><span class="line">            <span class="keyword">if</span> (context <span class="keyword">instanceof</span> AbstractApplicationContext) {</span><br><span class="line">                <span class="keyword">for</span> (ApplicationListener&lt;?&gt; listener : ((AbstractApplicationContext) context)</span><br><span class="line">                        .getApplicationListeners()) {</span><br><span class="line">                    <span class="keyword">this</span>.initialMulticaster.addApplicationListener(listener);</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">this</span>.initialMulticaster.setErrorHandler(<span class="keyword">new</span> LoggingErrorHandler());</span><br><span class="line">            <span class="keyword">this</span>.initialMulticaster.multicastEvent(event);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggingErrorHandler</span> <span class="keyword">implements</span> <span class="title">ErrorHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Log logger = LogFactory.getLog(EventPublishingRunListener.class);</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleError</span><span class="params">(Throwable throwable)</span> </span>{</span><br><span class="line">            logger.warn(<span class="string">"Error calling ApplicationEventListener"</span>, throwable);</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä»£ç æ¯”è¾ƒç®€å•ï¼Œèƒ–å‹è‡ªå·±ç…ç…å°±æ˜ç™½äº†ã€‚</li>
<li>é€šè¿‡è¿™æ ·çš„æ–¹å¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å°† SpringApplication å¯åŠ¨çš„å„ç§äº‹ä»¶ï¼Œæ–¹ä¾¿çš„ä¿®æ”¹æˆå¯¹åº”çš„ SpringApplicationEvent äº‹ä»¶ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸éœ€è¦ä¿®æ”¹ SpringApplication çš„ä»£ç ã€‚æˆ–è€…è¯´ï¼Œæˆ‘ä»¬è®¤ä¸º EventPublishingRunListener æ˜¯ä¸€ä¸ªâ€œ<strong>è½¬æ¢å™¨</strong>â€ã€‚</li>
</ul>
<p>å…³äº Spring Boot çš„äº‹ä»¶ï¼Œå¯ä»¥çœ‹çœ‹ <a href="https://www.kancloud.cn/letiantian/learn-spring-boot/712108" rel="external nofollow noopener noreferrer" target="_blank">ã€Šäº‹ä»¶ç›‘å¬ä¸å‘å¸ƒã€‹</a> æ–‡ç« ã€‚</p>
<h1 id="666-å½©è›‹"><a href="#666-å½©è›‹" class="headerlink" title="666. å½©è›‹"></a>666. å½©è›‹</h1><p>æ•´å—ä»£ç ç•¥å¾®æœ‰ç‚¹é•¿ï¼Œèƒ–å‹ä¸€å®šä¸€å®šä¸€å®šè‡ªå·±è°ƒè¯•ä¸‹ã€‚æ€»çš„æ¥è¯´ï¼Œé€»è¾‘å¹¶ä¸å¤æ‚ï¼Œæ˜¯å§ï¼Ÿæ˜¯å§ï¼</p>
<p>å‚è€ƒå’Œæ¨èå¦‚ä¸‹æ–‡ç« ï¼š</p>
<ul>
<li><p>å¿«ä¹å´‡æ‹œ <a href="https://gitbook.cn/books/5a445f030173cb29d2041d61/index.html" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring Boot æºç æ·±å…¥åˆ†æã€‹</a></p>
<blockquote>
<p>éœ€è¦ä»˜è´¹ 3 å—é’±ã€‚ä½ çœ‹ï¼Œè‰¿è‰¿ä¸ºäº†å†™å¥½æºç è§£æï¼Œè¿˜æ˜¯å»å­¦ä¹ äº†ä¸‹åˆ«äººçš„åšå®¢ã€‚</p>
</blockquote>
</li>
<li><p>è€ç”° <a href="http://www.54tianzhisheng.cn/2018/04/30/springboot_SpringApplication/" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring Boot 2.0 ç³»åˆ—æ–‡ç« (ä¸ƒ)ï¼šSpringApplication æ·±å…¥æ¢ç´¢ã€‹</a></p>
</li>
<li>oldflame-Jm <a href="https://blog.csdn.net/jamet/article/details/77413189" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring bootæºç åˆ†æ-SpringApplicationå¯åŠ¨ï¼ˆ1ï¼‰ã€‹</a></li>
<li>dm_vincent <ul>
<li><a href="https://blog.csdn.net/dm_vincent/article/details/76735888" rel="external nofollow noopener noreferrer" target="_blank">ã€Š[Spring Boot] 1. Spring Boot å¯åŠ¨è¿‡ç¨‹æºç åˆ†æã€‹</a></li>
<li><a href="https://blog.csdn.net/dm_vincent/article/details/77151122" rel="external nofollow noopener noreferrer" target="_blank">ã€Š[Spring Boot] 2. Spring Boot å¯åŠ¨è¿‡ç¨‹å®šåˆ¶åŒ–ã€‹</a> </li>
</ul>
</li>
<li>ä¸€ä¸ªåŠªåŠ›çš„ç å†œ<blockquote>
<p>è®¾è®¡ Spring Framework çš„éƒ¨åˆ†ï¼Œä»–ä¹Ÿå†™äº†ä¸€äº›~</p>
<ul>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78914752" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ2-SpringApplicationåˆå§‹åŒ–ã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78914803" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ3-SpringApplication#runã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78914944" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ4-SpringApplication#runç¬¬4æ­¥ã€‹</a> </li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78915135" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ5-SpringApplication#runç¬¬5æ­¥ã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78915181" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ6-SpringApplication#runç¬¬6æ­¥ã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78915189" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ7-SpringApplication#runç¬¬7æ­¥ã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78915211" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ8-SpringApplication#runç¬¬8æ­¥ã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78915221" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ9-SpringApplication#runç¬¬9æ­¥ã€‹</a></li>
<li><a href="https://blog.csdn.net/qq_26000415/article/details/78915234" rel="external nofollow noopener noreferrer" target="_blank">ã€Šspring boot æºç è§£æ10-SpringApplication#runç¬¬10-13æ­¥ã€‹</a></li>
</ul>
</blockquote>
</li>
</ul>




</div>