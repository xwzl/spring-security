<div class="article-entry" itemprop="articleBody">

<h1 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h1><p>åœ¨ <a href="http://svip.iocoder.cn/Spring-Boot/SpringApplication/">ã€Šç²¾å°½ Spring Boot æºç åˆ†æ â€”â€” SpringApplicationã€‹</a> ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ° <code>SpringApplication#createApplicationContext()</code> æ–¹æ³•ï¼Œæ ¹æ®ä¸åŒçš„ Web åº”ç”¨ç±»å‹ï¼Œåˆ›å»ºä¸åŒçš„ Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// SpringApplication.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class name of application context that will be used by default for non-web</span></span><br><span class="line"><span class="comment"> * environments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_CONTEXT_CLASS = <span class="string">"org.springframework.context."</span></span><br><span class="line">		+ <span class="string">"annotation.AnnotationConfigApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class name of application context that will be used by default for web</span></span><br><span class="line"><span class="comment"> * environments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_SERVLET_WEB_CONTEXT_CLASS = <span class="string">"org.springframework.boot."</span></span><br><span class="line">		+ <span class="string">"web.servlet.context.AnnotationConfigServletWebServerApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The class name of application context that will be used by default for reactive web</span></span><br><span class="line"><span class="comment"> * environments.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_REACTIVE_WEB_CONTEXT_CLASS = <span class="string">"org.springframework."</span></span><br><span class="line">		+ <span class="string">"boot.web.reactive.context.AnnotationConfigReactiveWebServerApplicationContext"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> ConfigurableApplicationContext <span class="title">createApplicationContext</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// æ ¹æ® webApplicationType ç±»å‹ï¼Œè·å¾— ApplicationContext ç±»å‹</span></span><br><span class="line">	Class&lt;?&gt; contextClass = <span class="keyword">this</span>.applicationContextClass;</span><br><span class="line">	<span class="keyword">if</span> (contextClass == <span class="keyword">null</span>) {</span><br><span class="line">		<span class="keyword">try</span> {</span><br><span class="line">			<span class="keyword">switch</span> (<span class="keyword">this</span>.webApplicationType) {</span><br><span class="line">			<span class="keyword">case</span> SERVLET:</span><br><span class="line">				contextClass = Class.forName(DEFAULT_SERVLET_WEB_CONTEXT_CLASS);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> REACTIVE:</span><br><span class="line">				contextClass = Class.forName(DEFAULT_REACTIVE_WEB_CONTEXT_CLASS);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				contextClass = Class.forName(DEFAULT_CONTEXT_CLASS);</span><br><span class="line">			}</span><br><span class="line">		} <span class="keyword">catch</span> (ClassNotFoundException ex) {</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Unable create a default ApplicationContext, "</span> + <span class="string">"please specify an ApplicationContextClass"</span>, ex);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">// åˆ›å»º ApplicationContext å¯¹è±¡</span></span><br><span class="line">	<span class="keyword">return</span> (ConfigurableApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>æœ¬æ–‡ï¼Œæˆ‘ä»¬è¦åˆ†äº«çš„å°±æ˜¯ï¼Œ<code>SERVLET</code> ç±»å‹å¯¹åº”çš„ Spring å®¹å™¨ç±»å‹  <strong>AnnotationConfigServletWebServerApplicationContext</strong> ç±»ã€‚</li>
</ul>
<p>AnnotationConfigServletWebServerApplicationContext çš„ç±»å›¾å…³ç³»å¦‚ä¸‹ï¼š<img src="http://static2.iocoder.cn/images/Spring-Boot/2021-01-16/01.jpg" alt="ç±»å›¾"></p>
<ul>
<li>æœ¬æ–‡ï¼Œæˆ‘ä»¬åªé‡ç‚¹çœ‹ ServletWebServerApplicationContext å’Œ AnnotationConfigServletWebServerApplicationContext ç±»ã€‚</li>
<li><p>ä¸ºäº†é˜…è¯»çš„å‹å¥½æ€§ï¼Œè‰¿è‰¿å¸Œæœ›èƒ–å‹é˜…è¯»è¿‡ <a href="http://svip.iocoder.cn/Spring-MVC/context-init-integration-with-Servlet-3.0/">ã€Šç²¾å°½ Spring MVC æºç åˆ†æ â€”â€” å®¹å™¨çš„åˆå§‹åŒ–ï¼ˆä¸‰ï¼‰ä¹‹ Servlet 3.0 é›†æˆã€‹</a> å’Œ <a href="http://svip.iocoder.cn/Spring-MVC/context-init-integration-with-SpringBoot/">ã€Šç²¾å°½ Spring MVC æºç åˆ†æ â€”â€” å®¹å™¨çš„åˆå§‹åŒ–ï¼ˆå››ï¼‰ä¹‹ Spring Boot é›†æˆã€‹</a> ä¸¤æ–‡ã€‚</p>
<blockquote>
<p>è‰¿è‰¿ï¼šåšç€è„¸çš®è¯´ï¼Œä¸Šé¢ä¸¤ç¯‡æ–‡ç« æåˆ°çš„å†…å®¹ï¼ŒåŸºæœ¬å°±ä¸å†èµ˜è¿°ã€‚<br>æ—ç™½å›ï¼šçœŸä¸è¦è„¸ï¼</p>
</blockquote>
</li>
</ul>
<h1 id="2-ServletWebServerApplicationContext"><a href="#2-ServletWebServerApplicationContext" class="headerlink" title="2. ServletWebServerApplicationContext"></a>2. ServletWebServerApplicationContext</h1><p><code>org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext</code> ï¼Œå®ç° ConfigurableWebServerApplicationContext æ¥å£ï¼Œç»§æ‰¿ GenericWebApplicationContext ç±»ï¼ŒSpring Boot ä½¿ç”¨ Servlet Web æœåŠ¡å™¨çš„ ApplicationContext å®ç°ç±»ã€‚</p>
<ul>
<li><p><code>org.springframework.boot.web.servlet.context.ConfigurableWebServerApplicationContext</code> æ¥å£ï¼Œå®ç°å®ƒåï¼Œå¯ä»¥è·å¾—ç®¡ç† WebServer çš„èƒ½åŠ›ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ConfigurableWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ConfigurableWebServerApplicationContext</span> <span class="keyword">extends</span> <span class="title">ConfigurableApplicationContext</span>, <span class="title">WebServerApplicationContext</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Set the server namespace of the context.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@param</span> serverNamespace the server namespace</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@see</span> #getServerNamespace()</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setServerNamespace</span><span class="params">(String serverNamespace)</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><a href="https://github.com/YunaiV/spring-framework/blob/master/spring-context/src/main/java/org/springframework/context/ConfigurableApplicationContext.java" rel="external nofollow noopener noreferrer" target="_blank"><code>org.springframework.context.ConfigurableApplicationContext</code></a> ï¼Œæ˜¯ Spring Framework æä¾›çš„ç±»ï¼Œå°±ä¸ç»†çœ‹äº†ã€‚</li>
<li><p><code>org.springframework.boot.web.context.WebServerApplicationContext</code> ï¼Œç»§æ‰¿ ApplicationContext æ¥å£ï¼ŒWebServer ApplicationContext æ¥å£ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// WebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WebServerApplicationContext</span> <span class="keyword">extends</span> <span class="title">ApplicationContext</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Returns the {<span class="doctag">@link</span> WebServer} that was created by the context or {<span class="doctag">@code</span> null} if</span></span><br><span class="line"><span class="comment">	 * the server has not yet been created.</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> the web server</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">WebServer <span class="title">getWebServer</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Returns the namespace of the web server application context or {<span class="doctag">@code</span> null} if no</span></span><br><span class="line"><span class="comment">	 * namespace has been set. Used for disambiguation when multiple web servers are</span></span><br><span class="line"><span class="comment">	 * running in the same application (for example a management context running on a</span></span><br><span class="line"><span class="comment">	 * different port).</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span> the server namespace</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function">String <span class="title">getServerNamespace</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>é‡ç‚¹æ˜¯ï¼Œå¯ä»¥è·å¾— WebServer çš„æ–¹æ³•ã€‚ğŸ˜ˆ å› ä¸ºè·å¾—å®ƒï¼Œå¯ä»¥åšå„ç§ WebServer çš„ç®¡ç†ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p><a href="https://github.com/YunaiV/spring-framework/blob/master/spring-web/src/main/java/org/springframework/web/context/support/GenericWebApplicationContext.java" rel="external nofollow noopener noreferrer" target="_blank"><code>org.springframework.web.context.support.GenericWebApplicationContext</code></a> ï¼Œæ˜¯ Spring Framework æä¾›çš„ç±»ï¼Œå°±ä¸ç»†çœ‹å•¦ã€‚</p>
</li>
</ul>
<h2 id="2-1-æ„é€ æ–¹æ³•"><a href="#2-1-æ„é€ æ–¹æ³•" class="headerlink" title="2.1 æ„é€ æ–¹æ³•"></a>2.1 æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constant value for the DispatcherServlet bean name. A Servlet bean with this name</span></span><br><span class="line"><span class="comment"> * is deemed to be the "main" servlet and is automatically given a mapping of "/" by</span></span><br><span class="line"><span class="comment"> * default. To change the default behavior you can use a</span></span><br><span class="line"><span class="comment"> * {<span class="doctag">@link</span> ServletRegistrationBean} or a different bean name.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DISPATCHER_SERVLET_NAME = <span class="string">"dispatcherServlet"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Spring  WebServer å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">volatile</span> WebServer webServer;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Servlet ServletConfig å¯¹è±¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> ServletConfig servletConfig;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡ {<span class="doctag">@link</span> #setServerNamespace(String)} æ³¨å…¥ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ä¸è¿‡è²Œä¼¼ï¼Œä¸€ç›´æ²¡è¢«æ³¨å…¥è¿‡ï¼Œå¯ä»¥æš‚æ—¶å…ˆæ— è§†</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> String serverNamespace;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ServletWebServerApplicationContext</span><span class="params">()</span> </span>{</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ServletWebServerApplicationContext</span><span class="params">(DefaultListableBeanFactory beanFactory)</span> </span>{</span><br><span class="line">	<span class="keyword">super</span>(beanFactory);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ç®€å•çœ‹çœ‹å³å¯ã€‚</li>
</ul>
<p>å› ä¸ºåç»­çš„é€»è¾‘ï¼Œæ¶‰åŠåˆ° Spring å®¹å™¨çš„åˆå§‹åŒ–çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ç®€å•çœ‹çœ‹ <code>AbstractApplicationContext#refresh()</code> çš„æ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// AbstractApplicationContext.java</span></span><br><span class="line"><span class="comment">// `#refresh()` æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ... ç®€åŒ–ç‰ˆä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Allows post-processing of the bean factory in context subclasses.</span></span><br><span class="line">postProcessBeanFactory(beanFactory); <span class="comment">// &lt;1&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Invoke factory processors registered as beans in the context.</span></span><br><span class="line">invokeBeanFactoryPostProcessors(beanFactory);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Register bean processors that intercept bean creation.</span></span><br><span class="line">registerBeanPostProcessors(beanFactory);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize message source for this context.</span></span><br><span class="line">initMessageSource();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize event multicaster for this context.</span></span><br><span class="line">initApplicationEventMulticaster();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Initialize other special beans in specific context subclasses.</span></span><br><span class="line">onRefresh(); <span class="comment">// &lt;2&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Check for listener beans and register them.</span></span><br><span class="line">registerListeners();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Instantiate all remaining (non-lazy-init) singletons.</span></span><br><span class="line">finishBeanFactoryInitialization(beanFactory);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Last step: publish corresponding event.</span></span><br><span class="line">finishRefresh(); <span class="comment">// &lt;3&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>è¿™ä¸ªæ–¹æ³•ï¼Œä¼šè¢«è¦†å†™ã€‚å…·ä½“å¯ä»¥çœ‹ <a href="#">ã€Œ2.2 refreshã€</a> å°èŠ‚ã€‚ä½†æ˜¯ï¼Œå³ä½¿è¦†å†™äº†ï¼Œè¿˜æ˜¯ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚</li>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)</code> æ–¹æ³•ï¼Œå…·ä½“å¯ä»¥çœ‹ <a href="#">ã€Œ2.3 postProcessBeanFactoryã€</a> å°èŠ‚ã€‚</p>
<blockquote>
<p>å¯¹ Spring BeanFactoryPostProcessor çš„æœºåˆ¶ï¼Œå¯ä»¥çœ‹çœ‹ <a href="http://svip.iocoder.cn/Spring/IoC-BeanFactoryPostProcessor">ã€Šã€æ­»ç£• Springã€‘â€”â€” IoC ä¹‹æ·±å…¥åˆ†æ BeanFactoryPostProcessorã€‹</a></p>
</blockquote>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#onRefresh()</code> æ–¹æ³•ï¼Œå…·ä½“å¯ä»¥çœ‹ <a href="#">ã€Œ2.4 onRefreshã€</a> å°èŠ‚ã€‚</p>
</li>
<li><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#finishRefresh()</code> æ–¹æ³•ï¼Œå…·ä½“å¯ä»¥çœ‹ <a href="#">ã€Œ2.5 finishRefreshã€</a> å°èŠ‚ã€‚</li>
</ul>
<h2 id="2-2-refresh"><a href="#2-2-refresh" class="headerlink" title="2.2 refresh"></a>2.2 refresh</h2><p>è¦†å†™ <code>#refresh()</code> æ–¹æ³•ï¼Œåˆå§‹åŒ– Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">refresh</span><span class="params">()</span> <span class="keyword">throws</span> BeansException, IllegalStateException </span>{</span><br><span class="line">	<span class="keyword">try</span> {</span><br><span class="line">		<span class="keyword">super</span>.refresh();</span><br><span class="line">	} <span class="keyword">catch</span> (RuntimeException ex) {</span><br><span class="line">		<span class="comment">// &lt;X&gt; å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåœæ­¢ WebServer</span></span><br><span class="line">		stopAndReleaseWebServer();</span><br><span class="line">		<span class="keyword">throw</span> ex;</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä¸»è¦æ˜¯ <code>&lt;X&gt;</code> å¤„ï¼Œå¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™è°ƒç”¨ <code>#stopAndReleaseWebServer()</code> æ–¹æ³•ï¼Œåœæ­¢ WebServerã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.2.1 stopAndReleaseWebServerã€</a> ã€‚</li>
</ul>
<h3 id="2-2-1-stopAndReleaseWebServer"><a href="#2-2-1-stopAndReleaseWebServer" class="headerlink" title="2.2.1 stopAndReleaseWebServer"></a>2.2.1 stopAndReleaseWebServer</h3><p><code>#stopAndReleaseWebServer()</code> æ–¹æ³•ï¼Œåœæ­¢ WebServerã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">stopAndReleaseWebServer</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// è·å¾— WebServer å¯¹è±¡ï¼Œé¿å…è¢«å¤šçº¿ç¨‹ä¿®æ”¹äº†</span></span><br><span class="line">    WebServer webServer = <span class="keyword">this</span>.webServer;</span><br><span class="line">    <span class="keyword">if</span> (webServer != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">// åœæ­¢ WebServer å¯¹è±¡</span></span><br><span class="line">            webServer.stop();</span><br><span class="line">            <span class="comment">// ç½®ç©º webServer</span></span><br><span class="line">            <span class="keyword">this</span>.webServer = <span class="keyword">null</span>;</span><br><span class="line">        } <span class="keyword">catch</span> (Exception ex) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(ex);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="2-3-postProcessBeanFactory"><a href="#2-3-postProcessBeanFactory" class="headerlink" title="2.3 postProcessBeanFactory"></a>2.3 postProcessBeanFactory</h2><p>è¦†å†™ <code>#postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)</code> æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postProcessBeanFactory</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> </span>{</span><br><span class="line">	<span class="comment">// &lt;1.1&gt; æ³¨å†Œ WebApplicationContextServletContextAwareProcessor</span></span><br><span class="line">	beanFactory.addBeanPostProcessor(<span class="keyword">new</span> WebApplicationContextServletContextAwareProcessor(<span class="keyword">this</span>));</span><br><span class="line">	<span class="comment">// &lt;1.2&gt; å¿½ç•¥ ServletContextAware æ¥å£ã€‚</span></span><br><span class="line">	beanFactory.ignoreDependencyInterface(ServletContextAware.class);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// &lt;2&gt; æ³¨å†Œ ExistingWebApplicationScopes</span></span><br><span class="line">	registerWebApplicationScopes();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>&lt;1.1&gt;</code> å¤„ï¼Œæ³¨å†Œ WebApplicationContextServletContextAwareProcessor ã€‚WebApplicationContextServletContextAwareProcessor çš„ä½œç”¨ï¼Œä¸»è¦æ˜¯å¤„ç†å®ç° ServletContextAware æ¥å£çš„ Bean ã€‚åœ¨è¿™ä¸ªå¤„ç†ç±»ï¼Œåˆå§‹åŒ–è¿™ä¸ª Bean ä¸­çš„ ServletContext å±æ€§ï¼Œè¿™æ ·åœ¨å®ç° ServletContextAware æ¥å£çš„ Bean ä¸­å°±å¯ä»¥æ‹¿åˆ° ServletContext å¯¹è±¡äº†ï¼ŒSpring ä¸­ Aware æ¥å£å°±æ˜¯è¿™æ ·å®ç°çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// WebApplicationContextServletContextAwareProcessor.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebApplicationContextServletContextAwareProcessor</span> <span class="keyword">extends</span> <span class="title">ServletContextAwareProcessor</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> ConfigurableWebApplicationContext webApplicationContext;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">WebApplicationContextServletContextAwareProcessor</span><span class="params">(ConfigurableWebApplicationContext webApplicationContext)</span> </span>{</span><br><span class="line">		Assert.notNull(webApplicationContext, <span class="string">"WebApplicationContext must not be null"</span>);</span><br><span class="line">		<span class="keyword">this</span>.webApplicationContext = webApplicationContext;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> ServletContext <span class="title">getServletContext</span><span class="params">()</span> </span>{</span><br><span class="line">		ServletContext servletContext = <span class="keyword">this</span>.webApplicationContext.getServletContext();</span><br><span class="line">		<span class="keyword">return</span> (servletContext != <span class="keyword">null</span>) ? servletContext : <span class="keyword">super</span>.getServletContext();</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>{</span><br><span class="line">		ServletConfig servletConfig = <span class="keyword">this</span>.webApplicationContext.getServletConfig();</span><br><span class="line">		<span class="keyword">return</span> (servletConfig != <span class="keyword">null</span>) ? servletConfig : <span class="keyword">super</span>.getServletConfig();</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>è¿™æ ·ï¼Œå°±å¯ä»¥ä» <code>webApplicationContext</code> ä¸­ï¼Œè·å¾— ServletContext å’Œ ServletConfig å±æ€§ã€‚</li>
</ul>
</li>
<li><code>&lt;1.2&gt;</code> å¤„ï¼Œå¿½ç•¥ ServletContextAware æ¥å£ï¼Œå› ä¸ºå®ç° ServletContextAware æ¥å£çš„ Bean åœ¨ <code>&lt;1.1&gt;</code> ä¸­çš„ WebApplicationContextServletContextAwareProcessor ä¸­å·²ç»å¤„ç†äº†ã€‚</li>
<li><p>å…³äº <code>&lt;1.1&gt;</code> å’Œ <code>&lt;1.2&gt;</code> å¤„çš„è¯´æ˜ï¼Œå‚è€ƒ <a href="https://www.jianshu.com/p/58974c12cd6a" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring Boot æºç 3 â€”â€” refresh ApplicationContextã€‹</a> æ–‡ç« ã€‚</p>
<blockquote>
<p>è‰¿è‰¿ï¼šå½“è¯»æºç ç¢°åˆ°å›°éš¾æ—¶ï¼Œä¹Ÿè¦å–„ç”¨æœç´¢å¼•æ“ï¼Œå»å¯»æ‰¾ç­”æ¡ˆã€‚ğŸ˜ˆ æ¯•ç«Ÿï¼Œæœ‰æ—¶å€™è„‘å­ä¸ä¸€å®šèƒ½å¿«é€Ÿæƒ³çš„æ˜ç™½ã€‚å“ˆå“ˆå“ˆå“ˆ~</p>
</blockquote>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#registerWebApplicationScopes()</code> æ–¹æ³•ï¼Œæ³¨å†Œ ExistingWebApplicationScopes ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">registerWebApplicationScopes</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// åˆ›å»º ExistingWebApplicationScopes å¯¹è±¡</span></span><br><span class="line">    ExistingWebApplicationScopes existingScopes = <span class="keyword">new</span> ExistingWebApplicationScopes(getBeanFactory());</span><br><span class="line">    <span class="comment">// æ³¨å†Œ ExistingWebApplicationScopes åˆ° WebApplicationContext ä¸­</span></span><br><span class="line">    WebApplicationContextUtils.registerWebApplicationScopes(getBeanFactory());</span><br><span class="line">    <span class="comment">// æ¢å¤</span></span><br><span class="line">    existingScopes.restore();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å¯ä»¥å…ˆä¸ç»†ç ”ç©¶~</li>
</ul>
</li>
</ul>
<h2 id="2-4-onRefresh"><a href="#2-4-onRefresh" class="headerlink" title="2.4 onRefresh"></a>2.4 onRefresh</h2><p>è¦†å†™ <code>#onRefresh()</code> æ–¹æ³•ï¼Œåœ¨å®¹å™¨åˆå§‹åŒ–æ—¶ï¼Œå®Œæˆ WebServer çš„åˆ›å»ºï¼ˆä¸åŒ…æ‹¬å¯åŠ¨ï¼‰ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// &lt;1&gt; è°ƒç”¨çˆ¶æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">super</span>.onRefresh();</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="comment">// åˆ›å»º WebServer</span></span><br><span class="line">        createWebServer();</span><br><span class="line">    } <span class="keyword">catch</span> (Throwable ex) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(<span class="string">"Unable to start web server"</span>, ex);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨çˆ¶ <code>#onRefresh()</code> æ–¹æ³•ï¼Œæ‰§è¡Œçˆ¶é€»è¾‘ã€‚è¿™å—ï¼Œæš‚æ—¶ä¸ç”¨äº†è§£ã€‚</li>
<li><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#createWebServer()</code> æ–¹æ³•ï¼Œåˆ›å»º WebServer å¯¹è±¡ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.4.1 createWebServerã€</a> ã€‚</li>
</ul>
<h3 id="2-4-1-createWebServer"><a href="#2-4-1-createWebServer" class="headerlink" title="2.4.1 createWebServer"></a>2.4.1 createWebServer</h3><p><code>#createWebServer()</code> æ–¹æ³•ï¼Œåˆ›å»º WebServer å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createWebServer</span><span class="params">()</span> </span>{</span><br><span class="line">    WebServer webServer = <span class="keyword">this</span>.webServer;</span><br><span class="line">    ServletContext servletContext = getServletContext();</span><br><span class="line">    <span class="comment">// &lt;1&gt; å¦‚æœ webServer ä¸ºç©ºï¼Œè¯´æ˜æœªåˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">if</span> (webServer == <span class="keyword">null</span> &amp;&amp; servletContext == <span class="keyword">null</span>) {</span><br><span class="line">        <span class="comment">// &lt;1.1&gt; è·å¾— ServletWebServerFactory å¯¹è±¡</span></span><br><span class="line">        ServletWebServerFactory factory = getWebServerFactory();</span><br><span class="line">        <span class="comment">// &lt;1.2&gt; è·å¾— ServletContextInitializer å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// &lt;1.3&gt; åˆ›å»ºï¼ˆè·å¾—ï¼‰ WebServer å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">this</span>.webServer = factory.getWebServer(getSelfInitializer());</span><br><span class="line">    <span class="comment">// TODO 1002 èŠ‹è‰¿è¿™ä¸ªæƒ…å†µæ˜¯ï¼Ÿ</span></span><br><span class="line">    } <span class="keyword">else</span> <span class="keyword">if</span> (servletContext != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            getSelfInitializer().onStartup(servletContext);</span><br><span class="line">        } <span class="keyword">catch</span> (ServletException ex) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(<span class="string">"Cannot initialize servlet context"</span>, ex);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// &lt;3&gt; åˆå§‹åŒ– PropertySource</span></span><br><span class="line">    initPropertySources();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œå¦‚æœ webServer ä¸ºç©ºï¼Œè¯´æ˜æœªåˆå§‹åŒ–ã€‚</p>
<ul>
<li><p><code>&lt;1.1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#getWebServerFactory()</code> æ–¹æ³•ï¼Œè·å¾— ServletWebServerFactory å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> ServletWebServerFactory <span class="title">getWebServerFactory</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// Use bean names so that we don't consider the hierarchy</span></span><br><span class="line">    <span class="comment">// è·å¾— ServletWebServerFactory ç±»å‹å¯¹åº”çš„ Bean çš„åå­—ä»¬</span></span><br><span class="line">    String[] beanNames = getBeanFactory().getBeanNamesForType(ServletWebServerFactory.class);</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ 0 ä¸ªï¼ŒæŠ›å‡º ApplicationContextException å¼‚å¸¸ï¼Œå› ä¸ºè‡³å°‘è¦ä¸€ä¸ª</span></span><br><span class="line">    <span class="keyword">if</span> (beanNames.length == <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(<span class="string">"Unable to start ServletWebServerApplicationContext due to missing "</span> + <span class="string">"ServletWebServerFactory bean."</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// å¦‚æœæ˜¯ &gt; 1 ä¸ªï¼ŒæŠ›å‡º ApplicationContextException å¼‚å¸¸ï¼Œå› ä¸ºä¸çŸ¥é“åˆå§‹åŒ–å“ªä¸ª</span></span><br><span class="line">    <span class="keyword">if</span> (beanNames.length &gt; <span class="number">1</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(<span class="string">"Unable to start ServletWebServerApplicationContext due to multiple "</span> + <span class="string">"ServletWebServerFactory beans : "</span> + StringUtils.arrayToCommaDelimitedString(beanNames));</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// è·å¾— ServletWebServerFactory ç±»å‹å¯¹åº”çš„ Bean å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> getBeanFactory().getBean(beanNames[<span class="number">0</span>], ServletWebServerFactory.class);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤å¤„è¿”å›çš„ä¼šæ˜¯ <code>org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory</code> å¯¹è±¡ã€‚</li>
<li>åœ¨æˆ‘ä»¬å¼•å…¥ <code>spring-boot-starter-web</code> ä¾èµ–æ—¶ï¼Œé»˜è®¤ä¼šå¼•å…¥ <code>spring-boot-starter-tomcat</code> ä¾èµ–ã€‚æ­¤æ—¶ï¼Œ<code>org.springframework.boot.autoconfigure.web.servlet.ServletWebServerFactoryConfiguration</code> åœ¨è‡ªåŠ¨é…ç½®æ—¶ï¼Œä¼šé…ç½®å‡º TomcatServletWebServerFactory Bean å¯¹è±¡ã€‚å› æ­¤ï¼Œæ­¤æ—¶ä¼šè·å¾— TomcatServletWebServerFactory å¯¹è±¡ã€‚</li>
</ul>
</li>
<li><p><code>&lt;1.2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#getSelfInitializer()</code> æ–¹æ³•ï¼Œè·å¾— ServletContextInitializer å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> org.springframework.boot.web.servlet.<span class="function">ServletContextInitializer <span class="title">getSelfInitializer</span><span class="params">()</span> </span>{</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">this</span>::selfInitialize; <span class="comment">// å’Œä¸‹é¢ç­‰ä»·</span></span><br><span class="line"><span class="comment">//        return new ServletContextInitializer() {</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public void onStartup(ServletContext servletContext) throws ServletException {</span></span><br><span class="line"><span class="comment">//                selfInitialize(servletContext);</span></span><br><span class="line"><span class="comment">//            }</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//        };</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>å˜»å˜»ï¼Œè¿”å›çš„æ˜¯ ServletContextInitializer åŒ¿åå¯¹è±¡ï¼Œå†…éƒ¨ä¼šè°ƒç”¨ <code>#selfInitialize(servletContext)</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šåœ¨ WebServer åˆ›å»ºåï¼Œè¿›è¡Œåˆå§‹åŒ–ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.4.2 finishRefreshã€</a> å°èŠ‚ã€‚</li>
</ul>
</li>
<li><code>&lt;1.3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>ServletWebServerFactory#getWebServer(ServletContextInitializer)</code> æ–¹æ³•ï¼Œåˆ›å»ºï¼ˆè·å¾—ï¼‰ WebServer å¯¹è±¡ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šè°ƒç”¨ <a href="#">ã€Œ2.4.2 selfInitializeã€</a> æ–¹æ³•ã€‚</li>
</ul>
</li>
<li>è‡³æ­¤ï¼Œå’Œ <a href="http://svip.iocoder.cn/Spring-MVC/context-init-integration-with-SpringBoot">ã€Šç²¾å°½ Spring MVC æºç åˆ†æ â€”â€” å®¹å™¨çš„åˆå§‹åŒ–ï¼ˆå››ï¼‰ä¹‹ Spring Boot é›†æˆã€‹</a> æ–‡ç« ï¼ŒåŸºæœ¬æ˜¯èƒ½ç©¿èµ·æ¥äº†ã€‚</li>
<li><code>&lt;2&gt;</code> å¤„ï¼ŒTODO 1002 ä¸çŸ¥é“åŸå› ã€‚æœ‰çŸ¥é“çš„èƒ–å‹ï¼Œæ˜Ÿçƒé‡Œå‘ŠçŸ¥ä¸‹å“Ÿã€‚</li>
<li><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨çˆ¶ <code>#initPropertySources()</code> æ–¹æ³•ï¼Œåˆå§‹åŒ– PropertySource ã€‚</li>
</ul>
<h3 id="2-4-2-selfInitialize"><a href="#2-4-2-selfInitialize" class="headerlink" title="2.4.2 selfInitialize"></a>2.4.2 selfInitialize</h3><p><code>#selfInitialize()</code> æ–¹æ³•ï¼Œåˆå§‹åŒ– WebServer ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">selfInitialize</span><span class="params">(ServletContext servletContext)</span> <span class="keyword">throws</span> ServletException </span>{</span><br><span class="line">    <span class="comment">// &lt;1&gt; æ·»åŠ  Spring å®¹å™¨åˆ° servletContext å±æ€§ä¸­ã€‚</span></span><br><span class="line">    prepareWebApplicationContext(servletContext);</span><br><span class="line">    <span class="comment">// &lt;2&gt; æ³¨å†Œ ServletContextScope</span></span><br><span class="line">    registerApplicationScope(servletContext);</span><br><span class="line">    <span class="comment">// &lt;3&gt; æ³¨å†Œ web-specific environment beans ("contextParameters", "contextAttributes")</span></span><br><span class="line">    WebApplicationContextUtils.registerEnvironmentBeans(getBeanFactory(), servletContext);</span><br><span class="line">    <span class="comment">// &lt;4&gt; è·å¾—æ‰€æœ‰ ServletContextInitializer ï¼Œå¹¶é€ä¸ªè¿›è¡Œå¯åŠ¨</span></span><br><span class="line">    <span class="keyword">for</span> (ServletContextInitializer beans : getServletContextInitializerBeans()) {</span><br><span class="line">        beans.onStartup(servletContext);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><p><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#prepareWebApplicationContext(ServletContext servletContext)</code> æ–¹æ³•ï¼Œæ·»åŠ  Spring å®¹å™¨åˆ° servletContext å±æ€§ä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">prepareWebApplicationContext</span><span class="params">(ServletContext servletContext)</span> </span>{</span><br><span class="line">    <span class="comment">// å¦‚æœå·²ç»åœ¨ ServletContext ä¸­ï¼Œåˆ™æ ¹æ®æƒ…å†µè¿›è¡Œåˆ¤æ–­ã€‚</span></span><br><span class="line">    Object rootContext = servletContext.getAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE);</span><br><span class="line">    <span class="keyword">if</span> (rootContext != <span class="keyword">null</span>) {</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯ç›¸åŒå®¹å™¨ï¼ŒæŠ›å‡º IllegalStateException å¼‚å¸¸ã€‚è¯´æ˜å¯èƒ½æœ‰é‡å¤çš„ ServletContextInitializers ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (rootContext == <span class="keyword">this</span>) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Cannot initialize context because there is already a root application context present - "</span> + <span class="string">"check whether you have multiple ServletContextInitializers!"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// å¦‚æœä¸åŒå®¹å™¨ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line">    Log logger = LogFactory.getLog(ContextLoader.class);</span><br><span class="line">    servletContext.log(<span class="string">"Initializing Spring embedded WebApplicationContext"</span>);</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">        <span class="comment">// &lt;X&gt; è®¾ç½®å½“å‰ Spring å®¹å™¨åˆ° ServletContext ä¸­</span></span><br><span class="line">        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, <span class="keyword">this</span>);</span><br><span class="line">        <span class="comment">// æ‰“å°æ—¥å¿—</span></span><br><span class="line">        <span class="keyword">if</span> (logger.isDebugEnabled()) {</span><br><span class="line">            logger.debug(<span class="string">"Published root WebApplicationContext as ServletContext attribute with name ["</span> + WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE + <span class="string">"]"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// &lt;Y&gt; è®¾ç½®åˆ° `servletContext` å±æ€§ä¸­ã€‚</span></span><br><span class="line">        setServletContext(servletContext);</span><br><span class="line">        <span class="comment">// æ‰“å°æ—¥å¿—</span></span><br><span class="line">        <span class="keyword">if</span> (logger.isInfoEnabled()) {</span><br><span class="line">            <span class="keyword">long</span> elapsedTime = System.currentTimeMillis() - getStartupDate();</span><br><span class="line">            logger.info(<span class="string">"Root WebApplicationContext: initialization completed in "</span> + elapsedTime + <span class="string">" ms"</span>);</span><br><span class="line">        }</span><br><span class="line">    } <span class="keyword">catch</span> (RuntimeException | Error ex) {</span><br><span class="line">        logger.error(<span class="string">"Context initialization failed"</span>, ex);</span><br><span class="line">        servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, ex);</span><br><span class="line">        <span class="keyword">throw</span> ex;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>è™½ç„¶ä»£ç éå¸¸é•¿ï¼Œä½†æ˜¯æ ¸å¿ƒåœ¨ <code>&lt;X&gt;</code> å’Œ <code>&lt;Y&gt;</code> å¤„ã€‚</li>
<li>é€šè¿‡ <code>&lt;X&gt;</code> å¤„ï¼Œä» <code>servletContext</code> çš„å±æ€§ç§ï¼Œå¯ä»¥æ‹¿åˆ°å…¶æ‹¥æœ‰çš„ Spring å®¹å™¨ã€‚</li>
<li>é€šè¿‡ <code>&lt;Y&gt;</code> å¤„ï¼ŒSpring å®¹å™¨çš„ <code>servletContext</code> å±æ€§ï¼Œå¯ä»¥æ‹¿åˆ° ServletContext å¯¹è±¡ã€‚</li>
</ul>
</li>
<li><p><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#registerApplicationScope(ServletContext servletContext)</code> æ–¹æ³•ï¼Œæ³¨å†Œ ServletContextScope ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">registerApplicationScope</span><span class="params">(ServletContext servletContext)</span> </span>{</span><br><span class="line">	ServletContextScope appScope = <span class="keyword">new</span> ServletContextScope(servletContext);</span><br><span class="line">	getBeanFactory().registerScope(WebApplicationContext.SCOPE_APPLICATION, appScope);</span><br><span class="line">	<span class="comment">// Register as ServletContext attribute, for ContextCleanupListener to detect it.</span></span><br><span class="line">	servletContext.setAttribute(ServletContextScope.class.getName(), appScope);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>ä¸ç”¨ç»†äº†è§£ã€‚</li>
</ul>
</li>
<li><p><code>&lt;3&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>WebApplicationContextUtils#registerEnvironmentBeans(ConfigurableListableBeanFactory bf, ServletContext sc)</code> æ–¹æ³•ï¼Œæ³¨å†Œ web-specific environment beans <code>("contextParameters", "contextAttributes")</code> ã€‚è¿™æ ·ï¼Œä» BeanFactory ä¸­ï¼Œä¹Ÿå¯ä»¥è·å¾—åˆ° <code>servletContext</code> ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æš‚æ—¶ä¸ç”¨ç»†äº†è§£ã€‚</p>
</li>
<li><code>&lt;4&gt;</code> å¤„ï¼Œè·å¾—æ‰€æœ‰ ServletContextInitializer ï¼Œå¹¶é€ä¸ªè¿›è¡Œå¯åŠ¨ã€‚å…³äºè¿™å—çš„è§£æï¼Œæˆ‘ä»¬åœ¨ <a href="http://svip.iocoder.cn/Spring-MVC/context-init-integration-with-SpringBoot">ã€Šç²¾å°½ Spring MVC æºç åˆ†æ â€”â€” å®¹å™¨çš„åˆå§‹åŒ–ï¼ˆå››ï¼‰ä¹‹ Spring Boot é›†æˆã€‹</a> ä¸­ï¼Œå·²ç»è¯¦ç»†å†™åˆ°ã€‚ğŸ˜ˆ </li>
<li>è‡³æ­¤ï¼Œå†…åµŒçš„ Servlet Web æœåŠ¡å™¨ï¼Œå·²ç»èƒ½å¤Ÿè¢«è¯·æ±‚äº†ã€‚</li>
</ul>
<h2 id="2-5-finishRefresh"><a href="#2-5-finishRefresh" class="headerlink" title="2.5 finishRefresh"></a>2.5 finishRefresh</h2><p>è¦†å†™ <code>#finishRefresh()</code> æ–¹æ³•ï¼Œåœ¨å®¹å™¨åˆå§‹åŒ–å®Œæˆæ—¶ï¼Œå¯åŠ¨ WebServer ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">finishRefresh</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// &lt;1&gt; è°ƒç”¨çˆ¶æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">super</span>.finishRefresh();</span><br><span class="line">    <span class="comment">// &lt;2&gt; å¯åŠ¨ WebServer</span></span><br><span class="line">    WebServer webServer = startWebServer();</span><br><span class="line">    <span class="comment">// &lt;3&gt; å¦‚æœåˆ›å»º WebServer æˆåŠŸï¼Œå‘å¸ƒ ServletWebServerInitializedEvent äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (webServer != <span class="keyword">null</span>) {</span><br><span class="line">        publishEvent(<span class="keyword">new</span> ServletWebServerInitializedEvent(webServer, <span class="keyword">this</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#finishRefresh()</code> æ–¹æ³•ï¼Œæ‰§è¡Œçˆ¶é€»è¾‘ã€‚è¿™å—ï¼Œæš‚æ—¶ä¸ç”¨äº†è§£ã€‚</li>
<li><code>&lt;2&gt;</code> å¤„ï¼Œè°ƒç”¨ <code>#startWebServer()</code> æ–¹æ³•ï¼Œå¯åŠ¨ WebServer ã€‚è¯¦ç»†è§£æï¼Œè§ <a href="#">ã€Œ2.5.1 startWebServerã€</a> ã€‚</li>
<li><code>&lt;3&gt;</code> å¤„ï¼Œå¦‚æœåˆ›å»º WebServer æˆåŠŸï¼Œå‘å¸ƒ ServletWebServerInitializedEvent äº‹ä»¶ã€‚</li>
</ul>
<h3 id="2-5-1-startWebServer"><a href="#2-5-1-startWebServer" class="headerlink" title="2.5.1 startWebServer"></a>2.5.1 startWebServer</h3><p><code>#startWebServer()</code> æ–¹æ³•ï¼Œå¯åŠ¨ WebServer ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> WebServer <span class="title">startWebServer</span><span class="params">()</span> </span>{</span><br><span class="line">	WebServer webServer = <span class="keyword">this</span>.webServer;</span><br><span class="line">	<span class="keyword">if</span> (webServer != <span class="keyword">null</span>) {</span><br><span class="line">		webServer.start();</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> webServer;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="2-6-onClose"><a href="#2-6-onClose" class="headerlink" title="2.6 onClose"></a>2.6 onClose</h2><p>è¦†å†™ <code>#onClose()</code> æ–¹æ³•ï¼Œåœ¨ Spring å®¹å™¨è¢«å…³é—­æ—¶ï¼Œå…³é—­ WebServer ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// ServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onClose</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// è°ƒç”¨çˆ¶æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">super</span>.onClose();</span><br><span class="line">    <span class="comment">// åœæ­¢ WebServer</span></span><br><span class="line">    stopAndReleaseWebServer();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h1 id="3-AnnotationConfigServletWebServerApplicationContext"><a href="#3-AnnotationConfigServletWebServerApplicationContext" class="headerlink" title="3. AnnotationConfigServletWebServerApplicationContext"></a>3. AnnotationConfigServletWebServerApplicationContext</h1><p><code>org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext</code> ï¼Œç»§æ‰¿ ServletWebServerApplicationContext ç±»ï¼Œå®ç° AnnotationConfigRegistry æ¥å£ï¼Œè¿›ä¸€æ­¥æä¾›äº†ä¸¤ä¸ªåŠŸèƒ½ï¼š</p>
<blockquote>
<p>è‰¿è‰¿ï¼šä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨ä¸åˆ°è¿™ä¸¤ä¸ªåŠŸèƒ½ã€‚ç®€å•çœ‹äº†ä¸‹ï¼Œæ›´å¤šçš„æ˜¯å•å…ƒæµ‹è¯•ï¼Œéœ€è¦ä½¿ç”¨åˆ°è¿™ä¸¤ä¸ªåŠŸèƒ½ã€‚</p>
</blockquote>
<ul>
<li>ä»æŒ‡å®šçš„ <code>basePackages</code> åŒ…ä¸­ï¼Œæ‰«æ BeanDefinition ä»¬ã€‚</li>
<li>ä»æŒ‡å®šçš„ <code>annotatedClasses</code> æ³¨è§£çš„é…ç½®ç±»ï¼ˆConfigurationï¼‰ä¸­ï¼Œè¯»å– BeanDefinition ä»¬ã€‚</li>
</ul>
<blockquote>
<p>æ‰€ä»¥å•Šï¼Œè¿™ç±»ï¼Œç®€å•çœ‹çœ‹å°±æˆå•¦ã€‚</p>
</blockquote>
<h2 id="3-1-æ„é€ æ–¹æ³•"><a href="#3-1-æ„é€ æ–¹æ³•" class="headerlink" title="3.1 æ„é€ æ–¹æ³•"></a>3.1 æ„é€ æ–¹æ³•</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// AnnotationConfigServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> AnnotatedBeanDefinitionReader reader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ClassPathBeanDefinitionScanner scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éœ€è¦è¢« {<span class="doctag">@link</span> #reader} è¯»å–çš„æ³¨å†Œç±»ä»¬</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> Set&lt;Class&lt;?&gt;&gt; annotatedClasses = <span class="keyword">new</span> LinkedHashSet&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * éœ€è¦è¢« {<span class="doctag">@link</span> #scanner} æ‰«æçš„åŒ…</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> String[] basePackages;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">AnnotationConfigServletWebServerApplicationContext</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>.reader = <span class="keyword">new</span> AnnotatedBeanDefinitionReader(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.scanner = <span class="keyword">new</span> ClassPathBeanDefinitionScanner(<span class="keyword">this</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">AnnotationConfigServletWebServerApplicationContext</span><span class="params">(DefaultListableBeanFactory beanFactory)</span> </span>{</span><br><span class="line">    <span class="keyword">super</span>(beanFactory);</span><br><span class="line">    <span class="keyword">this</span>.reader = <span class="keyword">new</span> AnnotatedBeanDefinitionReader(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.scanner = <span class="keyword">new</span> ClassPathBeanDefinitionScanner(<span class="keyword">this</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">AnnotationConfigServletWebServerApplicationContext</span><span class="params">(Class&lt;?&gt;... annotatedClasses)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>();</span><br><span class="line">    <span class="comment">// &lt;1&gt; æ³¨å†ŒæŒ‡å®šçš„æ³¨è§£çš„ç±»ä»¬</span></span><br><span class="line">    register(annotatedClasses);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– Spring å®¹å™¨</span></span><br><span class="line">    refresh();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">AnnotationConfigServletWebServerApplicationContext</span><span class="params">(String... basePackages)</span> </span>{</span><br><span class="line">    <span class="keyword">this</span>();</span><br><span class="line">    <span class="comment">// &lt;2&gt; æ‰«ææŒ‡å®šåŒ…</span></span><br><span class="line">    scan(basePackages);</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– Spring å®¹å™¨</span></span><br><span class="line">    refresh();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><code>&lt;1&gt;</code> å¤„ï¼Œå¦‚æœå·²ç»ä¼ å…¥ <code>annotatedClasses</code> å‚æ•°ï¼Œåˆ™è°ƒç”¨ <code>#register(Class&lt;?&gt;... annotatedClasses)</code> æ–¹æ³•ï¼Œè®¾ç½®åˆ° <code>annotatedClasses</code> ä¸­ã€‚ç„¶åï¼Œè°ƒç”¨ <code>#refresh()</code> æ–¹æ³•ï¼Œåˆå§‹åŒ– Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š  <figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// AnnotationConfigServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span> <span class="comment">// å®ç°è‡ª AnnotationConfigRegistry æ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(Class&lt;?&gt;... annotatedClasses)</span> </span>{</span><br><span class="line">	Assert.notEmpty(annotatedClasses, <span class="string">"At least one annotated class must be specified"</span>);</span><br><span class="line">	<span class="keyword">this</span>.annotatedClasses.addAll(Arrays.asList(annotatedClasses));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<ul>
<li><code>&lt;2&gt;</code> å¤„ï¼Œå¦‚æœå·²ç»ä¼ å…¥ <code>basePackages</code> å‚æ•°ï¼Œåˆ™è°ƒç”¨ <code>#scan(String... basePackages)</code> æ–¹æ³•ï¼Œè®¾ç½®åˆ° <code>annotatedClasses</code> ä¸­ã€‚ç„¶åï¼Œè°ƒç”¨ <code>#refresh()</code> æ–¹æ³•ï¼Œåˆå§‹åŒ– Spring å®¹å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š  <figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// AnnotationConfigServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">scan</span><span class="params">(String... basePackages)</span> </span>{</span><br><span class="line">	Assert.notEmpty(basePackages, <span class="string">"At least one base package must be specified"</span>);</span><br><span class="line">	<span class="keyword">this</span>.basePackages = basePackages;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<h2 id="3-2-prepareRefresh"><a href="#3-2-prepareRefresh" class="headerlink" title="3.2 prepareRefresh"></a>3.2 prepareRefresh</h2><p>è¦†å†™ <code>#prepareRefresh()</code> æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// AnnotationConfigServletWebServerApplicationContext.java</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span> <span class="comment">// å®ç°è‡ª AbstractApplicationContext æŠ½è±¡ç±»</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">prepareRefresh</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// æ¸…ç©º scanner çš„ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">this</span>.scanner.clearCache();</span><br><span class="line">    <span class="comment">// è°ƒç”¨çˆ¶ç±»</span></span><br><span class="line">    <span class="keyword">super</span>.prepareRefresh();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>åœ¨ Spring å®¹å™¨åˆå§‹åŒ–å‰ï¼Œéœ€è¦æ¸…ç©º <code>scanner</code> çš„ç¼“å­˜ã€‚</li>
</ul>
<h2 id="3-3-postProcessBeanFactory"><a href="#3-3-postProcessBeanFactory" class="headerlink" title="3.3 postProcessBeanFactory"></a>3.3 postProcessBeanFactory</h2><p>è¦†å†™ <code>#postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)</code> æ–¹æ³•ï¼Œæ‰§è¡Œ BeanDefinition çš„è¯»å–ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="Java"><span class="comment">// AnnotationConfigServletWebServerApplicationContext.java</span>

<span class="meta">@Override</span>
<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">postProcessBeanFactory</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> </span>{
<span class="comment">// è°ƒç”¨çˆ¶ç±»</span>
<span class="keyword">super</span>.postProcessBeanFactory(beanFactory);
<span class="comment">// æ‰«ææŒ‡å®šçš„åŒ…</span>
<span class="keyword">if</span> (<span class="keyword">this</span>.basePackages != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.basePackages.length &gt; <span class="number">0</span>) {
<span class="keyword">this</span>.scanner.scan(<span class="keyword">this</span>.basePackages);
}
<span class="comment">// æ³¨å†ŒæŒ‡å®šçš„æ³¨è§£çš„ç±»ä»¬å®šçš„</span>
<span class="keyword">if</span> (!<span class="keyword">this</span>.annotatedClasses.isEmpty()) {
<span class="keyword">this</span>.reader.register(ClassUtils.toClassArray(<span class="keyword">this</span>.annotatedClasses));
}
}
</code></pre>
<ul>
<li>å®é™…åœºæ™¯ä¸‹ï¼Œ<code>this.basePackages</code> å’Œ <code>annotatedClasses</code> éƒ½æ˜¯ç©ºçš„ã€‚æ‰€ä»¥å‘¢ï¼Œå“ˆå“ˆå“ˆå“ˆï¼ŒAnnotationConfigServletWebServerApplicationContext åŸºæœ¬æ²¡å•¥å­ç”¨~</li>
</ul>
<h1 id="666-å½©è›‹"><a href="#666-å½©è›‹" class="headerlink" title="666. å½©è›‹"></a>666. å½©è›‹</h1><p>ç®€å•å°æ–‡ä¸€ç¯‡~å¾ˆå¦¥~</p>
<p>å‚è€ƒå’Œæ¨èå¦‚ä¸‹æ–‡ç« ï¼š</p>
<ul>
<li>oldflame-Jm<ul>
<li><a href="https://blog.csdn.net/jamet/article/details/77417997" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring boot æºç åˆ†æ-AnnotationConfigApplicationContext é web ç¯å¢ƒä¸‹çš„å¯åŠ¨å®¹å™¨ï¼ˆ2ï¼‰ã€‹</a></li>
<li><a href="https://blog.csdn.net/jamet/article/details/77428946" rel="external nofollow noopener noreferrer" target="_blank">ã€ŠSpring boot æºç åˆ†æ-AnnotationConfigEmbeddedWebApplicationContext é»˜è®¤ web ç¯å¢ƒä¸‹çš„å¯åŠ¨å®¹å™¨ï¼ˆ3ï¼‰ã€‹</a> </li>
</ul>
</li>
</ul>




</div>